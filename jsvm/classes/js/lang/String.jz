js.lang.String = new function () {var REGX_HTML_ENCODE = /"|&|'|<|>|[\x00-\x20]|[\x7F-\xFF]|[\u0100-\u2700]/g;var REGX_HTML_DECODE = /&\w+;|&#(\d+);|<br\/>/g;var REGX_TRIM = /(^\s*)|(\s*$)/g;var REGX_REGEXP_METACHARS = /[\^\$\.\*\+\?\|\\\(\)\[\]\{\}]/g;var REGX_REGEXP_ESCAPEDMETACHARS = /\\([\^\$\.\*\+\?\|\\\(\)\[\]\{\}])/g;var HTML_DECODE = {"&lt;":"<", "&gt;":">", "&amp;":"&", "&nbsp;":" ", "&quot;":"\"", "&copy;":"\xa9", "<br/>":String.fromCharCode(10)};this.encodeHtml = String.prototype.encodeHtml = function (s, nobreak) {s = (s != undefined) ? s : this.toString();return (typeof s != "string") ? s : s.replace(REGX_HTML_ENCODE, function ($0) {var c = $0.charCodeAt(0), r = ["&#"];if (c == 13 || c == 10) {if (nobreak !== true) {return "<br/>";}}c = (c == 32) ? 160 : c;r.push(c);r.push(";");return r.join("");});};this.decodeHtml = String.prototype.decodeHtml = function (s, nobreak) {s = (s != undefined) ? s : this.toString();return (typeof s != "string") ? s : s.replace(REGX_HTML_DECODE, function ($0, $1) {var c = HTML_DECODE[$0];if (c == undefined) {if (!isNaN($1)) {c = String.fromCharCode(($1 == 160) ? 32 : $1);} else {c = $0;}}return c;});};this.escapeRegExp = String.prototype.escapeRegExp = function (s) {s = (s != undefined) ? s : this.toString();return (typeof s != "string") ? s : s.replace(REGX_REGEXP_METACHARS, function ($0) {return "\\" + $0;});};this.unescapeRegExp = String.prototype.unescapeRegExp = function (s) {s = (s != undefined) ? s : this.toString();return (typeof s != "string") ? s : s.replace(REGX_REGEXP_ESCAPEDMETACHARS, function ($0, ch) {return ch;});};this.trim = String.prototype.trim = function (s) {s = (s != undefined) ? s : this.toString();return (typeof s != "string") ? s : s.replace(REGX_TRIM, "");};this.matchBrackets = String.prototype.matchBrackets = function (lC, rC, s) {lC = lC || "{";rC = rC || "}";s = (s !== undefined) ? s : this.toString();var ks = 0, dqs = 0, sqs = 0, res = [], n = "", b = "", st = -1, en = -1;for (var i = 0; i < s.length; i++) {if (i !== 0) {b = n;}n = s.charAt(i);if (st !== -1 && (i - 1) >= 0 && b === "\\") {continue;}if (dqs || sqs) {if (n === "'") {if (sqs > 0) {sqs--;} else {if (n === "\"") {if (dqs > 0) {dqs--;}}}}} else {if (n === lC) {if (!ks) {st = i;}ks++;} else {if (n === rC) {ks--;if (!ks) {en = i;}} else {if (n === "\"") {dqs++;} else {if (n === "'") {sqs++;}}}}}if (st !== -1 && en !== -1) {res.push(s.substring(st, (parseInt(en) + 1)));st = en = -1;}}return res;};String.prototype.hashCode = function () {var hash = this._hash, _char;if (hash == undefined || hash == 0) {hash = 0;for (var i = 0, len = this.length; i < len; i++) {_char = this.charCodeAt(i);hash = 31 * hash + _char;hash = hash & hash;}hash = hash & 2147483647;this._hash = hash;}return this._hash;};}();