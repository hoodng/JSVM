$package("js.awt");$import("js.awt.FlexibleItem");js.awt.MenuItem = function (def, Runtime, menu, view) {var CLASS = js.awt.MenuItem, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;var Class = js.lang.Class, Event = js.util.Event, DOM = J$VM.DOM, System = J$VM.System;thi$.menuContainer = function () {return this.container;};thi$.subMenu = function () {return this._local.submenu;};thi$.setNodes = function (nodes) {var subMenu;if (Class.isArray(nodes)) {this.def.nodes = nodes;subMenu = this.subMenu();if (subMenu) {subMenu.hide();subMenu = this._local.submenu = null;}}};thi$.showSubMenu = function (nodes, force) {var M = this.def, menu = this.menuContainer(), subMenu = this.subMenu(), thickness;if (force === true && subMenu && Class.isArray(nodes)) {subMenu.hide();subMenu = this._local.submenu = null;}if (!subMenu && Class.isArray(nodes)) {subMenu = this._local.submenu = _createSubMenu.call(this, nodes, M.menuClass);}if (subMenu && !subMenu.isShown()) {thickness = M.beInMenu ? menu.getWidth() - 8 : this.getHeight();subMenu.showBy(this.view, M.beInMenu, thickness);}};thi$.onStateChanged = function () {arguments.callee.__super__.apply(this, arguments);if (this.isHover()) {var M = this.def, menu = this.menuContainer(), active = menu.active, subMenu, timeout;if (active && active != this) {subMenu = active.subMenu();if (subMenu && subMenu.isShown()) {subMenu.hide("hide", this);active.setHover(false);}}if (this.isEnabled()) {subMenu = this.subMenu();if (!subMenu && M.dynamic === true && (typeof this.loadMenu == "function")) {timeout = !isNaN(M.timeout) ? M.timeout : 500;this.loadMenu.$clearTimer();this.loadMenu.$delay(this, timeout);} else {this.showSubMenu(M.nodes);}}}}.$override(this.onStateChanged);thi$.getPeerComponent = function () {var peer;if (this.def.beInMenu) {peer = this.menuContainer().rootLayer().getPeerComponent();} else {peer = arguments.callee.__super__.apply(this, arguments);}return peer;}.$override(this.getPeerComponent);thi$.doLayout = function () {if (this.isCustomized()) {var customComp = this.getCustomComponent(), peer = customComp.getPeerComponent();if (!peer && DOM.isDOMElement(customComp.view)) {customComp.setPeerComponent(this.getPeerComponent());}}arguments.callee.__super__.apply(this, arguments);}.$override(this.doLayout);var _onInput = function (e) {e.cancelBubble();};var _createSubMenu = function (nodes, mClass) {var M = this.def, menuC = this.menuContainer(), menuD = menuC.def, mClassType = M.beInMenu ? menuD.classType : (M.mClassType || "js.awt.Menu"), menuShadow = M.beInMenu ? menuD.shadow : (M.menuShadow !== false), menudef = {classType:mClassType, className:mClass || menuD.className, id:this.def.id, nodes:nodes, shadow:menuShadow, PMFlag:7, isfloating:true}, pmenu, root;if (M.beInMenu) {pmenu = menuC.parentMenu();root = menuC.rootLayer();}var submenu = new (Class.forName(mClassType))(menudef, this.Runtime(), pmenu, root);if (!M.beInMenu) {submenu.setPeerComponent(this.getPeerComponent());}return submenu;};thi$.destroy = function () {if (this._local.submenu) {this._local.submenu.destroy();}delete this._local.submenu;arguments.callee.__super__.apply(this, arguments);}.$override(this.destroy);thi$._init = function (def, Runtime, menu, view) {if (def == undefined) {return;}def.classType = def.classType || "js.awt.MenuItem";def.className = menu.className + "_item";def.beInMenu = (def.beInMenu !== false);def.markable = (def.markable !== false);def.controlled = (def.beInMenu && (Class.isArray(def.nodes) || def.dynamic === true));if (def.beInMenu) {def.css = "position:relative;width:100%;";}arguments.callee.__super__.apply(this, [def, Runtime, view]);this.setContainer(menu);menu.cache[this.uuid()] = this;if (this.input) {Event.attachEvent(this.input, "mousedown", 0, this, _onInput);Event.attachEvent(this.input, "click", 0, this, _onInput);}}.$override(this._init);this._init.apply(this, arguments);}.$extend(js.awt.FlexibleItem);js.awt.MenuSeparator = function (def, Runtime, menu) {var CLASS = js.awt.MenuSeparator, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;var Class = js.lang.Class, Event = js.util.Event, DOM = J$VM.DOM, System = J$VM.System;thi$._init = function (def, Runtime, menu) {if (def == undefined) {return;}def.classType = "js.awt.MenuSeparator";def.className = menu.className + "_separator";def.css = "overflow:hidden;width:100%;";arguments.callee.__super__.apply(this, [def, Runtime]);}.$override(this._init);this._init.apply(this, arguments);}.$extend(js.awt.BaseComponent);