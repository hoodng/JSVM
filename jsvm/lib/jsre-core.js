J$VM = new function () {this.__product__ = "J$VM";this.__version__ = "0.9.";this.env = {j$vm_log:false, j$vm_ajax_nocache:true, j$vm_ajax_timeout:600000, j$vm_ajax_concurrent:8, j$vm_timeslice:20, j$vm_threshold:15, j$vm_longpress:300};var slice = Array.prototype.slice;this.env.j$vm_isworker = function () {try {return (window) ? false : true;}catch (x) {return true;}}();js = {lang:{}};(function () {this.$extend = function (superC) {var proto;if (typeof superC === "function") {proto = this.prototype = new (superC)();proto.constructor = superC;} else {if (typeof superC === "object") {proto = this.prototype = superC;proto.constructor = superC.constructor;} else {throw new Error("Parameter 'superC' must be a function or object");}}return this;};this.$implements = function (superCs) {var proto = this.prototype, superC, imps = proto.__imps__ = [].concat(proto.__imps__ || []);for (var i = 0, len = arguments.length; i < len; i++) {superC = arguments[i];if (typeof superC == "function") {imps.push(superC);superC.$decorate(proto);}}return this;};this.$decorate = function (o, replaceMap) {if (o === undefined) {throw new Error("Parameter 'o' must be an object");}var p, proto = this.prototype;if (this.__defined__ == undefined) {new (this)();}replaceMap = replaceMap || {};for (p in proto) {if (proto.hasOwnProperty(p) && "__imps__" != p && (!o.hasOwnProperty(p) || replaceMap[p] == true)) {o[p] = proto[p];}}return o;};this.$bind = function (thi$) {var fn = this, args = slice.call(arguments, 1);return function () {var $args = args.slice(0);$args = slice.call(arguments, 0).concat($args);return fn.apply(thi$, $args);};};this.$listen = function (thi$, eClass) {var fn = this, args = slice.call(arguments, 2);var agent = function (e) {var $args = args.slice(0);var _e = (typeof eClass === "function") ? new (eClass)(e) : e;$args.unshift(_e);return fn.apply(thi$, $args);};agent.__host__ = fn;return agent;};this.$delay = function (thi$, timeout) {var fn = this, args = slice.call(arguments, 2);fn.__timer__ = fn.__timer__ || [];var _timer = setTimeout(function () {fn.$clearTimer(_timer);fn.apply(thi$, args);}, timeout);fn.__timer__.push(_timer);return _timer;};this.$clearTimer = function (timer) {var timers = this.__timer__, index = -1, ret = false;if (timers && timers.length > 0) {if (timer != undefined && timer != null) {for (var i = 0, len = timers.length; i < len; i++) {if (timers[i] === timer) {index = i;break;}}if (index != -1) {timers.splice(index, 1);clearTimeout(timer);ret = true;}} else {clearTimeout(timers.shift());ret = true;}}return ret;};this.$override = function (func) {this.__super__ = func;return this;};$super = function (thisObj) {var caller = self.$super.caller, args;args = arguments.length > 1 ? slice.call(arguments, 1) : slice.call(caller.arguments);return caller.__super__.apply(thisObj, args);};this.$forEach = function (thi$, set) {var fn = this, i, len, $args = slice.call(arguments, 2), hasOwnProperty = Object.prototype.hasOwnProperty;switch (js.lang.Class.typeOf(set)) {case "array":for (i = 0, len = set.length; i < len; i++) {try {fn.apply(thi$, $args.concat(set[i], i, set));}catch (x) {if ("break" === x) {break;} else {throw x;}}}break;case "object":for (i in set) {if (!hasOwnProperty.call(set, i)) {continue;}try {fn.apply(thi$, $args.concat(set[i], i, set));}catch (x) {if ("break" === x) {break;} else {throw x;}}}break;default:break;}};this.$map = function (thi$, set) {var fn = this, ret = js.lang.Class.isArray(set) ? [] : {}, $args = slice.call(arguments, 2);(function (v, i, set) {ret[i] = fn.apply(thi$, $args.concat(v, i, set));}).$forEach(thi$, set);return ret;};this.$filter = function (thi$, set) {var fn = this, isArray = js.lang.Class.isArray(set), ret = isArray ? [] : {}, $args = slice.call(arguments, 2);(function (v, i, set) {if (fn.apply(thi$, $args.concat(v, i, set))) {isArray ? ret.push(v) : ret[i] = v;}}).$forEach(thi$, set);return ret;};this.$some = function (thi$, set) {var fn = this, ret = false, $args = slice.call(arguments, 2);(function (v, i, set) {if (fn.apply(thi$, $args.concat(v, i, set))) {ret = true;throw "break";}}).$forEach(thi$, set);return ret;};this.$every = function (thi$, set) {var fn = this, ret = true, $args = slice.call(arguments, 2);(function (v, i, set) {if (!fn.apply(thi$, $args.concat(v, i, set))) {ret = false;throw "break";}}).$forEach(thi$, set);return ret;};this.$delayLoop = function (thi$, timeout, iterator, context, callback) {var fn = this;if (iterator.index == iterator.length) {if (callback) {callback.call(thi$, context);}} else {(function () {fn.call(thi$, iterator, context);iterator.index += iterator.step;fn.$delayLoop(thi$, timeout, iterator, context, callback);}).$delay(thi$, timeout);}};this.$queued = function (callback, thi$, args) {var Class = js.lang.Class;Class.queued.apply(Class, [this].concat(slice.call(arguments)));};}).call(Function.prototype);self.$inject = function (target, fnName, inject, after) {var fn = target[fnName], ret;if (typeof fn !== "function" || typeof inject !== "function") {return;}target[fnName] = function () {if (!after) {inject(arguments);ret = self.$super(this);} else {ret = self.$super(this);inject(arguments);}return ret;}.$override(fn);};self.$debug = function (target, fnName) {self.$inject(target, fnName, function () {debugger;
});};Boolean.prototype.boolValue = function () {return this.valueOf();};String.prototype.boolValue = function () {return this.valueOf() === "true";};Number.prototype.boolValue = function () {return this.valueOf() !== 0;};}();

js.lang.Class = new function () {var _modules = {};this.packages = [];$package = this.definePackage = function (packageName) {if (_modules[packageName]) {return;}var names = packageName.split("."), parent = self, name, i, len;for (i = 0, len = names.length; i < len; i++) {name = names[i];if (parent[name] === undefined) {parent[name] = {};}parent = parent[name];}_modules[packageName] = parent;};$import = this.importClass = function (className) {var clazz = _checkClass(className), filePath;if (clazz != undefined) {return clazz;}try {filePath = _makeFilePath(className);_loadClass(filePath);clazz = _modules[className] = _checkClass(className);}catch (ex) {J$VM.System.err.println("Can't load " + className + " from " + filePath + "\n" + ex);}return clazz;};var _checkClass = function (className) {if (!className) {return undefined;}var clazz = _modules[className], names, name, i, len;if (clazz === undefined) {names = className.split(".");clazz = self;for (i = 0, len = names.length; i < len; i++) {name = names[i];if (clazz[name] === undefined) {clazz = undefined;break;}clazz = clazz[name];}_modules[className] = clazz;}return clazz;}.$bind(this);var _makeFilePath = function (className) {var buf = [], names, i, len;buf.push(J$VM.env.j$vm_home);buf.push("classes");names = className.split(".");for (i = 0, len = names.length; i < len; i++) {buf.push("/");buf.push(names[i]);}buf.push(".jz");return buf.join("");}.$bind(this);$load_package = this.loadClass = function (filePath, className) {if (className === undefined || _checkClass(className) == undefined) {try {_loadClass(filePath);}catch (ex) {J$VM.System.err.println("Can't load class from " + filePath);}}};var _loadClass = function (filePath) {if (!J$VM.env.j$vm_isworker) {var storage = J$VM.storage.cache, text, cached, incache = false, key = filePath.substring(J$VM.env.j$vm_home.length);cached = storage.getItem(key);if (cached) {if (cached.build && cached.build === J$VM.pkgversion[key]) {text = cached.text;incache = true;}}text = this.loadScript(!text ? filePath : null, text);if (!incache) {try {storage.setItem(key, {build:J$VM.pkgversion[key], text:text});}catch (x) {J$VM.System.err.println(x);}}} else {importScripts(filePath);}}.$bind(this);this.loadScript = function (filePath, text) {var b = !text;text = text || this.getResource(filePath, !this.isString(text));var script = document.createElement("script");var head = document.getElementsByTagName("head")[0];script.type = "text/javascript";script.text = text;head.appendChild(script);head.removeChild(script);if (b) {this.packages.push(filePath);}return text;};this.getResource = function (url, nocache, params) {var xhr = J$VM.XHRPool.getXHR(false), text, ex;xhr.setNoCache(nocache || false);xhr.open("GET", url, params);if (xhr.exception == undefined && xhr.readyState() == 4 && (xhr.status() == 200 || xhr.status() == 304)) {text = xhr.responseText();xhr.close();return text;} else {if (xhr.status() == 404) {return "";}}ex = xhr.exception;xhr.close();throw ex;};this.forName = function (className) {var clazz = _checkClass(className);if (clazz === undefined) {clazz = this.importClass(className);}return clazz;};this.loadImageFromUrl = function (image, url, callback, proxy) {var Q;Q = image.Q = [];Q.push([this, image, callback]);image.onload = _imageOnLoad.$bind(image);image.onreadystatechange = _imageOnStat.$bind(image);this._loadImage(image, url, proxy);};this.loadImage = function (url, callback, clone, proxy) {var cache = J$VM.storage.images, Q, image, dataUrl = true;if (url.indexOf("data:") != 0) {dataUrl = false;image = cache.getItem(url) || document.getElementById(url);}clone = clone || false;if (!this.isHtmlElement(image)) {image = J$VM.DOM.createElement("IMG");cache.setItem(url, image);this.loadImageFromUrl(image, url, callback, proxy);return;} else {if (image && image.onload != null) {if (clone) {Q = image.Q;Q.push([this, image, callback]);return;} else {image = J$VM.DOM.createElement("IMG");this.loadImageFromUrl(image, url, callback, proxy);return;}}}if (clone) {_onload.call(this, image, callback);} else {image = J$VM.DOM.createElement("IMG");this.loadImageFromUrl(image, url, callback);}};this._loadImage = function (image, url, proxy) {if (url.indexOf("data:") != 0) {url = new js.net.URI(url);if (url.isSameOrigin() || proxy !== true) {image.src = url.toURI();} else {var goProxy = ["webos", "HttpProxyGetAction", {target:url.toURI()}];image.src = ".vt?$=" + js.util.Base64.encode(JSON.stringify(goProxy));}} else {image.src = url;}};var _imageOnLoad = function () {var Q = this.Q, req;while (Q.length > 0) {req = Q.shift();_onload.apply(req.shift(), req);}this.onload = null;this.onreadystatechange = null;};var _imageOnStat = function () {if (this.readyState == "loaded" || this.readyState == "complete") {_imageOnLoad.call(this);}};var _onload = function (image, callback) {if (typeof callback === "function") {callback(image);}};this.typeOf = function (o) {return (o === null) ? "null" : (o === undefined) ? "undefined" : this.isHtmlElement(o) ? "html" + o.tagName.toLowerCase() + "element" : this.isBigInt(o) ? "bigint" : _typeof(o);};var _typeof = function (o) {var s = Object.prototype.toString.call(o);return s.substring(8, s.length - 1).toLowerCase();};this.isDate = function (o) {return this.typeOf(o) === "date" && !isNaN(o);};this.isBigInt = function (o) {return js.text && js.text.BigIntTools && (typeof o == "object") && (o instanceof js.text.BigIntTools.BigInt);};this.isArray = function (o) {return this.typeOf(o) === "array";};this.isString = function (o) {return typeof o === "string";};this.isNumber = function (o) {return !isNaN(o) && (typeof o === "number");};this.isObject = function (o) {return this.typeOf(o) === "object";};this.isPureObject = function (o) {return this.isObject(o) && (o.constructor === Object);};this.isBoolean = function (o) {return typeof o === "boolean";};this.isNull = function (o) {return this.typeOf(o) === "null";};this.isUndefined = function (o) {return this.typeOf(o) === "undefined";};this.isFunction = function (o) {return typeof o === "function";};this.isValid = function (o) {return (o != null) && (o != undefined);};this.isHtmlElement = function (o) {return o ? !!o.tagName : false;};this.isJSON = function (str) {if (!this.isString(str) || str.length == 0) {return false;}try {var obj = JSON.parse(str);return true;}catch (e) {return false;}};this.is = function (o, type) {var b = false;if (!this.isString(type) || type.length == 0) {return this.isValid(o);}type = type.toLowerCase();switch (type) {case "number":b = this.isNumber(o);break;case "date":b = this.isDate(o);break;default:b = (this.typeOf(o) === type);break;}return b;};this.isIn = function (e, set) {var b = false;if (!this.isValid(e)) {return b;}switch (this.typeOf(set)) {case "object":b = set.hasOwnProperty("" + e);break;case "array":if (typeof set.contains !== "function") {js.util.LinkedList.$decorate(set);}b = set.contains(e);break;default:break;}return b;};var tasks = [], scheduled = false;this.queued = function (fn, callback, thi$, args) {var task = {state:0, data:null, fn:fn}, curTask = tasks.length > 0 ? tasks[tasks.length - 1] : null;fn.ctx = {thi$:thi$, callback:callback, args:Array.prototype.slice.call(arguments, 3)};if (!curTask || curTask.state === 1) {tasks.push(task);scheduled = false;} else {curTask.tasks = (curTask.tasks || []);curTask.tasks.push(task);}if (!scheduled) {scheduled = true;_run.$delay(this, 0);}};var _run = function () {var fn, ctx, promise, curTask = tasks.length > 0 ? tasks[tasks.length - 1] : null;if (!curTask) {scheduled = false;return;}fn = curTask.fn;ctx = fn.ctx;switch (curTask.state) {case 0:curTask.state = 1;promise = {data:curTask.data, done:_done.$bind(this)};fn.apply(ctx.thi$ || this, [promise].concat(ctx.args));break;case 2:if (this.isFunction(ctx.callback)) {ctx.callback.apply(ctx.thi$ || this, [curTask.data].concat(ctx.args));}delete fn.ctx;var task = curTask.tasks ? curTask.tasks.shift() : null;if (task) {task.data = curTask.data;task.tasks = curTask.tasks;tasks[tasks.length - 1] = task;} else {curTask = tasks.pop();task = tasks.length > 0 ? tasks[tasks.length - 1] : null;if (task) {task.state = 2;task.data = curTask.data;}}curTask.data = null;curTask.tasks = null;curTask.fn = null;_run.call(this);break;default:throw new Error("Unexcept task state: " + curTask.state);break;}};var _done = function (result) {var curTask = tasks[tasks.length - 1];curTask.state = 2;curTask.data = result;_run.call(this);};}();

js.lang.Math = function () {var last = (new Date()).getTime(), d = (1 << 16) + (1 << 8) + 1, table = [0, 1996959894, 3993919788, 2567524794, 124634137, 1886057615, 3915621685, 2657392035, 249268274, 2044508324, 3772115230, 2547177864, 162941995, 2125561021, 3887607047, 2428444049, 498536548, 1789927666, 4089016648, 2227061214, 450548861, 1843258603, 4107580753, 2211677639, 325883990, 1684777152, 4251122042, 2321926636, 335633487, 1661365465, 4195302755, 2366115317, 997073096, 1281953886, 3579855332, 2724688242, 1006888145, 1258607687, 3524101629, 2768942443, 901097722, 1119000684, 3686517206, 2898065728, 853044451, 1172266101, 3705015759, 2882616665, 651767980, 1373503546, 3369554304, 3218104598, 565507253, 1454621731, 3485111705, 3099436303, 671266974, 1594198024, 3322730930, 2970347812, 795835527, 1483230225, 3244367275, 3060149565, 1994146192, 31158534, 2563907772, 4023717930, 1907459465, 112637215, 2680153253, 3904427059, 2013776290, 251722036, 2517215374, 3775830040, 2137656763, 141376813, 2439277719, 3865271297, 1802195444, 476864866, 2238001368, 4066508878, 1812370925, 453092731, 2181625025, 4111451223, 1706088902, 314042704, 2344532202, 4240017532, 1658658271, 366619977, 2362670323, 4224994405, 1303535960, 984961486, 2747007092, 3569037538, 1256170817, 1037604311, 2765210733, 3554079995, 1131014506, 879679996, 2909243462, 3663771856, 1141124467, 855842277, 2852801631, 3708648649, 1342533948, 654459306, 3188396048, 3373015174, 1466479909, 544179635, 3110523913, 3462522015, 1591671054, 702138776, 2966460450, 3352799412, 1504918807, 783551873, 3082640443, 3233442989, 3988292384, 2596254646, 62317068, 1957810842, 3939845945, 2647816111, 81470997, 1943803523, 3814918930, 2489596804, 225274430, 2053790376, 3826175755, 2466906013, 167816743, 2097651377, 4027552580, 2265490386, 503444072, 1762050814, 4150417245, 2154129355, 426522225, 1852507879, 4275313526, 2312317920, 282753626, 1742555852, 4189708143, 2394877945, 397917763, 1622183637, 3604390888, 2714866558, 953729732, 1340076626, 3518719985, 2797360999, 1068828381, 1219638859, 3624741850, 2936675148, 906185462, 1090812512, 3747672003, 2825379669, 829329135, 1181335161, 3412177804, 3160834842, 628085408, 1382605366, 3423369109, 3138078467, 570562233, 1426400815, 3317316542, 2998733608, 733239954, 1555261956, 3268935591, 3050360625, 752459403, 1541320221, 2607071920, 3965973030, 1969922972, 40735498, 2617837225, 3943577151, 1913087877, 83908371, 2512341634, 3803740692, 2075208622, 213261112, 2463272603, 3855990285, 2094854071, 198958881, 2262029012, 4057260610, 1759359992, 534414190, 2176718541, 4139329115, 1873836001, 414664567, 2282248934, 4279200368, 1711684554, 285281116, 2405801727, 4167216745, 1634467795, 376229701, 2685067896, 3608007406, 1308918612, 956543938, 2808555105, 3495958263, 1231636301, 1047427035, 2932959818, 3654703836, 1088359270, 936918000, 2847714899, 3736837829, 1202900863, 817233897, 3183342108, 3401237130, 1404277552, 615818150, 3134207493, 3453421203, 1423857449, 601450431, 3009837614, 3294710456, 1567103746, 711928724, 3020668471, 3272380065, 1510334235, 755167117];this.random = function (n) {return n ? Math.floor($super(this) * n + 1) : $super(this);}.$override(this.random);this.uuid = function (hash) {hash = hash || this.hash();return "s" + hash.toString(16);};this.hash = function () {var now = (new Date()).getTime();if (now <= last) {now = last + d;}return (last = now);};this.crc32 = function (str) {var crc = 0, c, i, len, n;if (!js.lang.Class.isString(str)) {return "0";}crc = crc ^ (-1);i = 0;len = str.length;while (i < len) {c = str.charCodeAt(i++);if (c <= 127) {crc = _crc(crc, c);} else {if (c >= 128 && c <= 32767) {crc = _crc(crc, ((c >> 6) & 31) | 192);crc = _crc(crc, (c & 63) | 128);} else {crc = _crc(crc, (c >> 12) | 224);crc = _crc(crc, ((c >> 6) & 63) | 128);crc = _crc(crc, (c & 63) | 128);}}}return ((crc ^ (-1)) >>> 0).toString(16);};var _crc = function (crc, c) {return (crc >>> 8) ^ table[(crc ^ c) & 255];};return this;}.call(self.Math);

js.lang.Object = function (o) {var CLASS = js.lang.Object, thi$ = CLASS.prototype;if (CLASS.__defined__) {return;}CLASS.__defined__ = true;var Class = js.lang.Class, Math = js.lang.Math, objectStore = {};thi$.hashCode = function () {this.__hash__ = this.__hash__ || Math.hash();return this.__hash__;};thi$.equals = function (o) {return o === this;};thi$.toString = function () {return (typeof this) + "@" + this.uuid();};thi$.uuid = function (id) {if (Class.isString(id)) {this.__uuid__ = id;} else {if (!Class.isString(this.__uuid__)) {this.__uuid__ = Math.uuid(this.hashCode());}}return this.__uuid__;};thi$.instanceOf = function (clazz) {var imps = this.__imps__;if (imps) {for (var i = 0, len = imps.length; i < len; i++) {if (clazz === imps[i]) {return true;}}}return this instanceof clazz;};thi$.destroy = function () {var uuid = this.uuid(), obj, p;obj = objectStore[uuid];delete objectStore[uuid];for (p in obj) {obj[p] = null;}J$VM.MQ.remove(uuid);for (p in this) {delete this[p];}this.destroied = true;};thi$.setContextID = function (ouuid) {var uuid = this.uuid(), obj = objectStore[uuid];if (!obj) {obj = objectStore[uuid] = {"__self__":this};}if (Class.isString(ouuid) && ouuid.length > 0) {obj["__contextid__"] = ouuid;}};thi$.getContextID = function () {var obj = objectStore[this.uuid()] || {};return obj["__contextid__"];};thi$.getObject = function (uuid) {var obj = objectStore[uuid] || {};return obj["__self__"];};thi$.getContext = function (uuid) {return objectStore[uuid || this.uuid()];};thi$.putContextAttr = function (attr, v) {if (!Class.isString(attr) || attr.length === 0 || !Class.isValid(v)) {return;}var obj = this.getContext();obj[attr] = v;};var _getContextAttr = function (uuid, attr, upward) {var obj = objectStore[uuid], ouuid, v;if (!obj) {return null;}if (obj.hasOwnProperty(attr)) {return obj[attr];}ouuid = obj["__contextid__"];if (ouuid && ouuid !== uuid && upward !== false) {v = _getContextAttr.call(this, ouuid, attr, upward);}return v;};thi$.getContextAttr = function (attr, upward, uuid) {return _getContextAttr.call(this, uuid || this.uuid(), attr, upward);};thi$.rmContextAttr = function (attr) {var obj = this.getContext();if (!obj || !Class.isString(attr) || attr === "__self__" || attr === "__contextid__") {return;}delete obj[attr];};}.$extend(Object);

js.lang.String = function () {var REGX_HTML_ENCODE = /"|&|'|<|>|[\x00-\x20]|[\x7F-\xFF]|[\u0100-\u2700]/g;var REGX_HTML_DECODE = /&\w+;|&#(\d+);|<br\/>/g;var REGX_TRIM = /(^\s*)|(\s*$)/g;var REGX_REGEXP_METACHARS = /[\^\$\.\*\+\?\|\\\(\)\[\]\{\}]/g;var REGX_REGEXP_ESCAPEDMETACHARS = /\\([\^\$\.\*\+\?\|\\\(\)\[\]\{\}])/g;var HTML_DECODE = {"&lt;":"<", "&gt;":">", "&amp;":"&", "&nbsp;":" ", "&quot;":"\"", "&copy;":"\xa9", "<br/>":String.fromCharCode(10)};var TAGTEST = {script:/<script\b[\s\S]*?>([\s\S]*?)<\/script/i, pre:/<pre\b[\s\S]*?>([\s\S]*?)<\/pre/i, TEXTAREA:/<TEXTAREA\b[\s\S]*?>([\s\S]*?)<\/TEXTAREA/i};var REGX_MEATACHARS_ESCAPE = {"^":"\\^", "$":"\\$", "(":"\\(", ")":"\\)", "[":"\\[", "{":"\\{", ".":"\\.", "*":"\\*", "\\":"\\\\", "|":"\\|", "<":"\\<", ">":"\\>", "+":"\\+", "?":"\\?"};var REGX_MEATACHARS_UNESCAPE = {"\\^":"^", "\\$":"$", "\\(":"(", "\\)":")", "\\[":"[", "\\{":"{", "\\.":".", "\\*":"*", "\\\\":"\\", "\\|":"|", "\\<":"<", "\\>":">", "\\+":"+", "\\?":"?"};this.encodeHtml = String.encodeHtml = function (s, nobreak, ignoreSpace) {s = (s != undefined) ? s : this.toString();var o;return (typeof s != "string") ? s : s.replace(REGX_HTML_ENCODE, function ($0) {var c = $0.charCodeAt(0), r = ["&#"];if (c == 13 && nobreak != true) {o = c;return "<br/>";}if (c == 10 && nobreak != true) {return (o == 13) ? "" : "<br/>";}if (c == 32 || c == 160) {if (ignoreSpace !== true) {c = (c == 32) ? 160 : c;} else {c = (c == 160) ? 32 : c;return String.fromCharCode(c);}}r.push(c);r.push(";");return r.join("");});};this.decodeHtml = String.decodeHtml = function (s, nobreak) {s = (s != undefined) ? s : this.toString();return (typeof s != "string") ? s : s.replace(REGX_HTML_DECODE, function ($0, $1) {var c = HTML_DECODE[$0];if (c == undefined) {if (!isNaN($1)) {c = String.fromCharCode(($1 == 160) ? 32 : $1);} else {c = $0;}}return c;});};this.escapeRegExp = String.escapeRegExp = function (s) {s = (s != undefined) ? s : this.toString();return (typeof s != "string") ? s : s.replace(REGX_REGEXP_METACHARS, function ($0) {return "\\" + $0;});};this.unescapeRegExp = String.unescapeRegExp = function (s) {s = (s != undefined) ? s : this.toString();return (typeof s != "string") ? s : s.replace(REGX_REGEXP_ESCAPEDMETACHARS, function ($0, ch) {return ch;});};this.escapeRxMetaChars = String.escapeRxMetaChars = function (s, emap) {if (!s || typeof s != "string") {return s;}var buf = [], ch, ech;for (var i = 0; i < s.length; i++) {ch = s.charAt(i);ech = emap ? emap[ch] : null;if (typeof ech != "string") {ech = REGX_MEATACHARS_ESCAPE[ch];}if (ech) {buf.push(ech);} else {buf.push(ch);}}return buf.join("");};this.unescapeRxMetaChars = String.unescapeRxMetaChars = function (s) {if (!s || typeof s != "string" || s.indexOf("\\") == -1) {return s;}var buf = [], ch, prech;for (var i = 0; i < s.length; i++) {ch = s.charAt(i);if (ch !== "\\") {if (prech) {ch = prech + ch;ch = REGX_MEATACHARS_UNESCAPE[ch] || ch;prech = null;}buf.push(ch);} else {prech = ch;}}return buf.join("");};this.trim = String.trim = this.trim || function () {var s = this.toString();return (typeof s != "string") ? s : s.replace(REGX_TRIM, "");};this.endsWith = this.endsWith || function (suffix) {return this.indexOf(suffix, this.length - suffix.length) !== -1;};this.startsWith = this.startsWith || function (suffix) {return this.indexOf(suffix) === 0;};this.fetchJSON = String.prototype.fetchJSON = function (tag, s) {tag = tag || "pre";s = (s != undefined) ? s : this.toString();var tester = TAGTEST[tag], ret;if (tester.test(s)) {ret = tester.exec(s);}return ret ? ret[1].trim() : s;};this.hashCode = this.hashCode || function () {var hash = this._hash, _char;if (hash == undefined || hash == 0) {hash = 0;for (var i = 0, len = this.length; i < len; i++) {_char = this.charCodeAt(i);hash = 31 * hash + _char;hash = hash & hash;}hash = hash & 2147483647;this._hash = hash;}return this._hash;};return String;}.call(String.prototype);

js.lang.StringBuffer = function (s) {var CLASS = js.lang.StringBuffer, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;thi$.append = function (s) {this._buf.push(s);return this;};thi$.clear = function () {this._buf.splice(0, this._buf.length);return this;};thi$.toString = function () {return this._buf.join("");};thi$._init = function (s) {this._buf = [];if (s) {this._buf.push(s);}};this._init.apply(this, arguments);}.$extend(js.lang.Object);

$package("js.util");js.util.LinkedList = function (array) {var CLASS = js.util.LinkedList, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init(array);return;}CLASS.__defined__ = true;thi$.getFirst = function () {if (this.length == 0) {throw new Error("NoSuchElementException");}return this[0];};thi$.getLast = function () {if (this.length == 0) {throw new Error("NoSuchElementException");}return this[this.length - 1];};thi$.addFirst = function (e) {this.add(0, e);};thi$.push = function (e) {$super(this);return this;}.$override(this.push);thi$.addLast = function (e) {this.push(e);};thi$.removeFirst = function () {return this.shift();};thi$.removeLast = function () {return this.pop();};thi$.add = function (index, e) {this.splice(index, 0, e);};thi$.set = function (index, e) {var oldVal = this[index];this[index] = e;return oldVal;};thi$.get = function (index) {return this[index];};thi$.remove0 = function (index) {var e = this.get(index);this.splice(index, 1);return e;};thi$.remove = function (e) {var idx = this.indexOf(e);return (idx != -1) ? this.remove0(idx) : null;};thi$.indexOf = function (e) {for (var i = 0, len = this.length; i < len; i++) {var _e = this[i];if (e instanceof js.lang.Object && _e instanceof js.lang.Object) {if (_e.equals(e)) {return i;}} else {if (_e === e) {return i;}}}return -1;};thi$.replace = function (e, newE) {var idx = this.indexOf(e);if (idx != -1) {this.splice(idx, 1, newE);}};thi$.contains = function (e) {return this.indexOf(e) != -1;};thi$.clear = function () {this.splice(0, this.length);return this;};thi$._init = function (array) {if (array && js.lang.Class.isArray(array)) {this.addLast.$forEach(this, array);}};this._init(array);}.$extend(Array);(function () {var $ = js.util.LinkedList;$.newInstance = function (array) {var o = js.lang.Class.isArray(array) ? array : [];return $.$decorate(o);};Array.prototype.$getLinkedList = function () {return $.$decorate(this);};Array.prototype.$indexOf = function (e) {for (var i = 0, len = this.length; i < len; i++) {if (this[i] === e) {return i;}}return -1;};Array.prototype.$contains = function (e) {return this.$indexOf(e) != -1;};})();

$package("js.util");js.util.HashMap = function (map) {var CLASS = js.util.HashMap, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;var Class = js.lang.Class;thi$.put = function (key, value) {if (!Class.isString(key) && !Class.isNumber(key)) {throw "The key must be a string or number";}if (!this.contains(key)) {this._size++;}this._vals[key] = value;};thi$.size = function () {return this._size;};thi$.contains = function (key) {return this._vals.hasOwnProperty(key);};thi$.get = function (key) {return this.contains(key) ? this._vals[key] : undefined;};thi$.remove = function (key) {var e = undefined;if (this.contains(key)) {e = this._vals[key];delete this._vals[key];this._size--;}return e;};thi$.keys = function () {var ret = [], vals = this._vals;for (var k in vals) {if (vals.hasOwnProperty(k)) {ret.push(k);}}return ret;};thi$.values = function () {var ret = [], vals = this._vals;for (var k in vals) {if (vals.hasOwnProperty(k)) {ret.push(vals[k]);}}return ret;};thi$.addAll = function (map) {for (var p in map) {if (map.hasOwnProperty(p)) {this.put(p, map[p]);}}};thi$.clear = function () {this._vals = {};this._size = 0;};thi$._init = function (map) {this._vals = map || {};var n = 0, vals = this._vals;for (var k in vals) {if (vals.hasOwnProperty(k)) {n++;}}this._size = n;};this._init.apply(this, arguments);}.$extend(js.lang.Object);

$package("js.util");js.util.Properties = function (map) {var CLASS = js.util.Properties, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;thi$.getProperty = function (key, defaultValue) {var tmp = this.get(key);return tmp == undefined ? defaultValue : tmp;};thi$.setProperty = function (key, value) {this.put(key, value);};this._init.apply(this, arguments);}.$extend(js.util.HashMap);

$package("js.util");js.util.Observable = function (def, Runtime) {var CLASS = js.util.Observable, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;var Class = js.lang.Class, Event = js.util.Event, List = js.util.LinkedList;thi$.addObserver = function (observer) {var svrs = this.__observers__;if (observer && observer.update && !svrs.contains(observer)) {svrs.addLast(observer);}};thi$.deleteObserver = function (observer) {this.__observers__.remove(observer);};thi$.deleteObservers = function () {this.__observers__.clear();};thi$.notifyObservers = function (data) {if (!this.hasChanged()) {return;}(function (observer) {observer.update(this, data);}).$forEach(this, this.__observers__);};thi$.hasChanged = function () {return this._local.changed;};thi$.setChanged = function () {this._local.changed = true;};thi$.clearChanged = function () {this._local.changed = false;};thi$.Runtime = function () {return this._local.Runtime;};thi$.destroy = function () {this.__observers__ = null;this._local = null;$super(this);}.$override(this.destroy);thi$._init = function (def, Runtime) {if (!Class.isObject(def)) {return;}this.def = def;this.uuid(def.uuid);this.__observers__ = List.$decorate([]);var U = this._local = this._local || {};U.Runtime = Runtime;U.changed = false;this.setContextID(def["__contextid__"]);};this._init.apply(this, arguments);}.$extend(js.lang.Object);

$package("js.util");js.util.Observer = function () {var CLASS = js.util.Observer, thi$ = CLASS.prototype;if (CLASS.__defined__) {return;}CLASS.__defined__ = true;thi$.update = function (observable, data) {};};

$package("js.util");js.util.Event = function (eventType, eventData, eventTarget) {var CLASS = js.util.Event, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init(eventType, eventData, eventTarget);return;}CLASS.__defined__ = true;thi$.getType = function () {return this._type;};thi$.setType = function (type) {this._type = type;};thi$.getTimeStamp = function () {return this._time;};thi$.getData = function () {return this._data;};thi$.setData = function (data) {this._data = data;};thi$.getEventTarget = function () {return this._target;};thi$.setEventTarget = function (eventTarget) {this._target = eventTarget;};thi$.cancelBubble = function () {this._bubble = false;};thi$.cancelDefault = function () {this._default = false;return this._default;};thi$._init = function (eventType, eventData, eventTarget) {this.setType(eventType);this.setData(eventData);this.setEventTarget(eventTarget);this._time = new Date();this._bubble = true;this._default = true;};this._init(eventType, eventData, eventTarget);}.$extend(js.lang.Object);(function () {var $ = js.util.Event;$.FLAG = {EXCLUSIVE:1 << 0, CAPTURED:1 << 1, CUSTOMIZED:1 << 2, check:function (f) {var o = {exclusive:false, captured:false, customized:false};if (typeof f === "number") {o.exclusive = (f & this.EXCLUSIVE) != 0;o.captured = (f & this.CAPTURED) != 0;o.customized = (f & this.CUSTOMIZED) != 0;} else {o.exclusive = (f === true);}return o;}};var _touchRelevant = function (dom, type) {return J$VM.DOM.getAttribute(dom, "touchcapture") === "true" && (type.startsWith("mouse") || type.endsWith("click"));};var _makeMouseEvent = function (type, touch) {var mouseEv = document.createEvent("MouseEvent");mouseEv.initMouseEvent(type, true, true, window, 1, touch.screenX, touch.screenY, touch.clientX, touch.clientY, false, false, false, false, 0, null);return mouseEv;};var _touch2mouse = function (e) {e.cancelBubble();var e0 = e._event, touch = e0.changedTouches[0], target = touch.target, evts = [];switch (e0.type) {case "touchstart":evts.push(_makeMouseEvent("mouseover", touch));evts.push(_makeMouseEvent("mousedown", touch));break;case "touchend":evts.push(_makeMouseEvent("mouseup", touch));evts.push(_makeMouseEvent("mouseout", touch));evts.push(_makeMouseEvent("click", touch));break;case "touchmove":evts.push(_makeMouseEvent("mousmove", touch));break;default:break;}while (evts.length > 0) {target.dispatchEvent.$delay(target, 0, evts.shift());}e.cancelDefault();};var _interceptTouch = function (dom, type, bind) {if (J$VM.supports.touchEnabled != true) {return;}var ttype;switch (type) {case "mousedown":case "mouseover":case "click":case "dblclick":ttype = "touchstart";break;case "mouseout":case "mouseup":case "click":case "dblclick":ttype = "touchend";break;case "mousemove":case "mousewheel":ttype = "touchmove";break;}if (bind === true) {$.attachEvent(dom, ttype, 0, $, _touch2mouse);} else {$.detachEvent(dom, ttype, 0, $, _touch2mouse);}};$.attachEvent = function (dom, eventType, flag, listener, handler) {var fn, args = Array.prototype.slice.call(arguments, 5), check = $.FLAG.check(flag), eClass = check.customized ? null : js.awt.Event;args.unshift(listener, eClass);fn = handler.$listen.apply(handler, args);fn.check = check;dom.__handlers__ = dom.__handlers__ || {};dom.__handlers__[eventType] = dom.__handlers__[eventType] || js.util.LinkedList.$decorate([]);dom.__handlers__[eventType].push(fn);if (check.exclusive) {dom["on" + eventType] = fn;} else {if (dom.addEventListener) {dom.addEventListener(eventType, fn, check.captured);if (_touchRelevant(dom, eventType)) {_interceptTouch(dom, eventType, true);}} else {dom.attachEvent("on" + eventType, fn);}}return fn;};$.detachEvent = function (dom, eventType, flag, listener, handler) {var fn, agents, check;dom.__handlers__ = dom.__handlers__ || {};dom.__handlers__[eventType] = dom.__handlers__[eventType] || js.util.LinkedList.$decorate([]);agents = dom.__handlers__[eventType];for (var i = 0, len = agents.length; i < len; i++) {fn = agents[i];if (fn && ((handler === fn.__host__) || (handler === undefined))) {check = fn.check;if (check.exclusive) {dom["on" + eventType] = null;} else {if (dom.removeEventListener) {dom.removeEventListener(eventType, fn, check.captured);if (_touchRelevant(dom, eventType)) {_interceptTouch(dom, eventType, false);}} else {dom.detachEvent("on" + eventType, fn);}}delete fn.__host__;delete fn.check;agents.remove0(i);}}if (agents.length == 0) {delete dom.__handlers__[eventType];}};$.W3C_EVT_LOAD = "load";$.W3C_EVT_UNLOAD = "unload";$.W3C_EVT_RESIZE = "resize";$.W3C_EVT_SELECTSTART = "selectstart";$.W3C_EVT_CONTEXTMENU = "contextmenu";$.W3C_EVT_MESSAGE = "message";$.W3C_EVT_ERROR = "error";$.W3C_EVT_MOUSE_DOWN = "mousedown";$.W3C_EVT_MOUSE_UP = "mouseup";$.W3C_EVT_MOUSE_MOVE = "mousemove";$.W3C_EVT_MOUSE_OVER = "mouseover";$.W3C_EVT_MOUSE_OUT = "mouseout";$.W3C_EVT_MOUSE_CLICK = "click";$.W3C_EVT_MOUSE_DBCLICK = "dbclick";$.W3C_EVT_MOUSE_WHEEL = "mousewheel";$.W3C_EVT_DRAGSTART = "dragstart";$.W3C_EVT_DRAGEND = "dragend";$.W3C_EVT_DRAGENTER = "dragenter";$.W3C_EVT_DRAGLEAVE = "dragleave";$.W3C_EVT_DRAGOVER = "dragover";$.W3C_EVT_DROP = "drop";$.W3C_EVT_KEY_DOWN = "keydown";$.W3C_EVT_KEY_UP = "keyup";$.SYS_EVT_STATECHANGED = "statechanged";$.SYS_EVT_SUCCESS = "success";$.SYS_EVT_HTTPERR = "httperr";$.SYS_EVT_TIMEOUT = "timeout";$.SYS_EVT_MOVING = "moving";$.SYS_EVT_MOVED = "moved";$.SYS_EVT_RESIZING = "resizing";$.SYS_EVT_RESIZED = "resized";$.SYS_EVT_ZINDEXCHANGED = "zindexchanged";$.SYS_EVT_GEOMCHANGED = "geomchanged";$.SYS_EVT_ELE_APPEND = "elementappend";$.SYS_EVT_ELE_REMOVED = "elementremoved";$.SYS_EVT_ELE_POSITION = "positionchanged";$.SYS_EVT_ELE_SIZE = "sizechanged";$.SYS_EVT_ELE_ZINDEX = "zindexchanged";$.SYS_EVT_ELE_ATTRS = "attrschanged";$.SYS_EVT_ELE_STYLE = "stylechanged";$.SYS_MSG_CONSOLEINF = "console_inf";$.SYS_MSG_CONSOLEERR = "console_err";$.SYS_MSG_CONSOLELOG = "console_log";})();

$package("js.util");js.util.EventListener = function (listener, handler) {var CLASS = js.util.EventListener, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init(listener, handler);return;}CLASS.__defined__ = true;thi$.handleEvent = function () {if (typeof this.handler === "function" && this.listener && this.listener.destroied != true) {this.handler.apply(this.listener, arguments);}};thi$.equals = function (o) {return o ? (o.listener === this.listener && o.handler === this.handler) : false;};thi$._init = function (l, h) {if (typeof l == "object" && typeof h == "function") {this.listener = l;this.handler = h;if (typeof l.uuid != "function") {var o = this.listener;o.hashCode = function () {if (!this._hash) {this._hash = js.lang.Math.random(new Date().getTime());}return this._hash;};o.uuid = function (id) {if (arguments.length > 0) {this._uuid = id;} else {if (!this._uuid) {this._uuid = js.lang.Math.uuid(this.hashCode());}}return this._uuid;};}this.uuid(l.uuid());}};this._init(listener, handler);}.$extend(js.lang.Object);

$package("js.util");$import("js.util.Observable");js.util.EventTarget = function (def, Runtime) {var CLASS = js.util.EventTarget, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;var Class = js.lang.Class, Event = js.util.Event, List = js.util.LinkedList, PreclusiveMouseKeyEvents = {mouseover:true, mousedown:true, mouseup:true, mouseout:true, mousemove:true, mousewheel:true, dommousescroll:true, click:true, dblclick:true, keydown:true, keyup:true};var _getListeners = function (eventType) {var hName = "on" + eventType, listeners = this[hName];if (!Class.isArray(listeners)) {listeners = this[hName] = List.$decorate([]);}return listeners;};thi$.addEventListener = function (eventType, fn, captured) {_getListeners.call(this, eventType).push(fn);};thi$.removeEventListener = function (eventType, fn, captured) {_getListeners.call(this, eventType).remove(fn);};var _prepareArgs = function (eventType, flag, listener, handler) {var check = Event.FLAG.check(flag), args = Array.prototype.slice.call(arguments, 0);if (check.customized) {args.unshift(this);} else {if (this.view != undefined) {args.unshift(this.view);} else {args.unshift(this);}}return args;};thi$.attachEvent = function (eventType, flag, listener, handler) {Event.attachEvent.apply(this, _prepareArgs.apply(this, arguments));};thi$.detachEvent = function (eventType, flag, listener, handler) {Event.detachEvent.apply(this, _prepareArgs.apply(this, arguments));};thi$.declareEvent = function (eventType) {this["on" + eventType] = null;};thi$.fireEvent = function (evt, bubble) {var eType, isEvent, handlers;if (Class.isString(evt)) {eType = evt;} else {if (evt instanceof Event) {eType = evt.getType();isEvent = true;}}if (!Class.isFunction(this.isCovered) || !this.isCovered() || !PreclusiveMouseKeyEvents[eType.toLowerCase()]) {handlers = this["on" + eType];switch (Class.typeOf(handlers)) {case "function":handlers.call(this, evt);break;case "array":for (var i = 0, len = handlers.length; i < len; i++) {handlers[i].call(this, evt);}break;default:break;}}if (isEvent && (bubble === true && evt._bubble === true)) {var src = this.view || evt.srcElement, target;do {src = src ? src.parentNode : null;target = src ? J$VM.DOM.getComponent(src) : null;} while (target && target === this);if (target && target.fireEvent) {target.fireEvent(evt, bubble);}}};thi$.canCapture = function () {var cap = this.def ? this.def.capture : false, parent;cap = cap || false;if (cap) {parent = this.getContainer ? this.getContainer() : null;cap = cap && ((parent && parent.canCapture) ? parent.canCapture() : false);}return cap;};thi$.destroy = function () {var eType, handlers = this.__handlers__;if (handlers) {for (eType in handlers) {this.detachEvent(eType, 4);}delete this.__handlers__;}handlers = this.view ? this.view.__handlers__ : undefined;if (handlers) {for (eType in handlers) {this.detachEvent(eType, 0);this.detachEvent(eType, 1);}this.view.__handlers__ = null;}$super(this);}.$override(this.destroy);thi$._init = function (def, Runtime) {if (!Class.isObject(def)) {return;}$super(this, def, Runtime);}.$override(this._init);this._init.apply(this, arguments);}.$extend(js.util.Observable);

$package("js.util");$import("js.util.LinkedList");$import("js.util.EventListener");js.util.Messenger = function () {var Class = js.lang.Class, List = js.util.LinkedList, Listener = js.util.EventListener, Q, running = false;this.register = function (msgId, receiver, handler) {var recvs = this.table[msgId];if (recvs === undefined) {recvs = List.newInstance([]);this.table[msgId] = recvs;}var recv = new Listener(receiver, handler);if (!recvs.contains(recv)) {recvs.push(recv);}};this.cancel = function (msgId, receiver, handler) {var recvs = this.table[msgId];if (recvs === undefined) {return;}var recv = new Listener(receiver, handler);var p = recvs.indexOf(recv);if (p != -1) {recvs.remove0(p);if (recvs.length === 0) {delete this.table[msgId];}}};this.remove = function (receiverId) {var indexOf = function (list, id) {for (var i = 0, len = list.length; i < len; i++) {if (list[i].uuid() === id) {return i;}}return -1;};var table = this.table, recvs, idx, p;for (p in table) {recvs = table[p];while ((idx = indexOf(recvs, receiverId)) != -1) {recvs.remove0(idx);}if (recvs.length == 0) {delete this.table[p];}}};this.post = function (msgId, msgData, recvs, device, priority) {var msg = [msgId, msgData, Class.typeOf(recvs) === "array" ? recvs : [], device === undefined ? null : device, priority === 0 ? 0 : (priority === 1 ? 1 : 1)];Q[msg[4]].push(msg);if (!running) {_schedule();}};var _schedule = function () {if (Q.isEmpty()) {running = false;} else {running = true;_dispatch.$delay(this, 0);}}.$bind(this);var _dispatch = function () {var msg = Q.get();if (Class.typeOf(msg) != "array") {_schedule();return;}var device = msg[3], g, recvs = this.table[msg[0]], recv;if (device != null) {msg[3] = null;if (J$VM.env.j$vm_isworker) {device.postMessage(JSON.stringify(msg));} else {device.postMessage(JSON.stringify(msg), "*");}} else {if (recvs != undefined && recvs.length > 0) {for (var i = 0, len = msg[2].length; i < len; i++) {if (g === undefined) {g = {};}g[msg[2][i]] = true;}for (i = 0, len = recvs.length; i < len; i++) {recv = recvs[i];if (g != undefined) {if (g[recv.uuid()]) {recv.handleEvent.$delay(recv, 0, msg[1]);}} else {recv.handleEvent.$delay(recv, 0, msg[1]);}}}}_schedule();}.$bind(this);this.send = function (msgId, msgData, rcvs, device, priority) {priority = priority === 0 ? 0 : (priority === 1 ? 1 : 1), device = device === undefined ? null : device, rcvs = Class.typeOf(rcvs) === "array" ? rcvs : [];var recvs = this.table[msgId], recv, g;if (device != null) {if (J$VM.env.j$vm_isworker) {device.postMessage(JSON.stringify([priority, null, rcvs, msgId, msgData]));} else {device.postMessage(JSON.stringify([priority, null, rcvs, msgId, msgData]), "*");}} else {if (recvs != undefined && recvs.length > 0) {for (var i = 0, len = rcvs.length; i < len; i++) {if (g === undefined) {g = {};}g[rcvs[i]] = true;}for (i = 0, len = recvs.length; i < len; i++) {recv = recvs[i];if (g != undefined) {if (g[recv.uuid()]) {recv.handleEvent(msgData);}} else {recv.handleEvent(msgData);}}}}};var _init = function () {this.table = {};Q = [[], []];Q.isEmpty = function () {return (this[0].length + this[1].length) == 0;};Q.get = function () {var o = this[0].shift();o = (o === undefined) ? this[1].shift() : o;return o;};_schedule();}.call(this);}.$extend(js.lang.Object);

$package("js.util");js.util.StyleSheet = function (nativeSheet) {var CLASS = js.util.StyleSheet, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;var Class = js.lang.Class, Event = js.util.Event, DOM = J$VM.DOM, System = J$VM.System, J$VMCSS = "/***__j$vm-css__***/";thi$.applyCSS = function (css) {var styleEle = DOM.getStyleSheetElement(this.nativeSheet);if (styleEle.styleSheet) {try {styleEle.styleSheet.cssText = comboCSSCode(styleEle.styleSheet.cssText, css);}catch (x) {}} else {styleEle.textContent = comboCSSCode(styleEle.textContent, css);}this._syncUpdate();};var comboCSSCode = function (ori, css) {var codes = ori.split(J$VMCSS), ret = [];for (var i = 0, len = codes.length; i < len; i++) {if (i == 0) {ret.push(codes[0]);ret.push(J$VMCSS);ret.push(css);ret.push(J$VMCSS);} else {if (i == 1) {continue;} else {ret.push(codes[i]);}}}return ret.join("\r\n");};thi$.getRule = function (selector) {return this.rules[selector];};thi$.addRule = function (selector, style) {style = style || {};var rule = this.getRule(selector), sheet, rules, cssText;if (Class.isObject(rule)) {cssText = DOM.toCssText(style);rule.style.cssText = cssText;} else {sheet = this.nativeSheet;rules = sheet.cssRules || sheet.rules;cssText = DOM.toCssText(style);if (sheet.insertRule) {sheet.insertRule([selector, "{", cssText, "}"].join(""), rules.length);} else {if (sheet.addRule) {sheet.addRule(selector, cssText, rules.length);}}rule = this.rules[selector] = {selector:selector, style:rules[rules.length - 1].style};}return rule;};var _parseSheet = function (sheet, rules) {var cssrules = sheet.cssRules || sheet.rules, rule, i, len, selector;for (i = 0, len = cssrules.length; i < len; i++) {rule = cssrules[i];selector = rule.selectorText;rules[selector] = {selector:selector, style:rule.style};}};thi$.destroy = function () {this.nativeSheet = null;this.id = null;this.href = null;this.rules = null;};thi$._syncUpdate = function () {var nativeSheet = DOM._findNativeStyleSheet(this.id, this.href);if (nativeSheet !== this.nativeSheet) {this._init(nativeSheet);}return this;};thi$._init = function (nativeSheet) {this.nativeSheet = nativeSheet;this.id = DOM.getStyleSheetElement(nativeSheet).id;this.href = nativeSheet.href;this.rules = {};_parseSheet.call(this, nativeSheet, this.rules);};this._init.apply(this, arguments);}.$extend(js.lang.Object);

$package("js.util");js.util.Document = function () {var CLASS = js.util.Document, thi$ = CLASS.prototype;if (CLASS.__defined__) {return;}CLASS.__defined__ = true;var Class = js.lang.Class, Event = js.util.Event, cache = {}, ATTRIBUTESCT = {acceptcharset:"acceptCharset", accesskey:"accessKey", allowtransparency:"allowTransparency", bgcolor:"bgColor", cellpadding:"cellPadding", cellspacing:"cellSpacing", "class":"className", colspan:"colSpan", checked:"defaultChecked", selected:"defaultSelected", "for":"htmlFor", frameborder:"frameBorder", hspace:"hSpace", longdesc:"longDesc", maxlength:"maxLength", marginwidth:"marginWidth", marginheight:"marginHeight", noresize:"noResize", noshade:"noShade", readonly:"readOnly", rowspan:"rowSpan", tabindex:"tabIndex", valign:"vAlign", vspace:"vSpace"}, BOOLATTRREGEXP = /^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noshade|nowrap|readonly|selected)$/, DOCTYPECT = {"html-4.01":{bodysize:false}, "html-4.01-transitional":{bodysize:true}}, REGX_CAMEL = /[A-Z]/g, REGX_HYPHEN = /-([a-z])/ig, textSps = ["font-family", "font-size", "font-style", "font-weight", "text-decoration", "text-align", "font-weight", "line-height"], camelMap = {}, hyphenMap = {};thi$.checkBrowser = function () {var supports = J$VM.supports = {reliableMarginRight:true, supportCssFloat:true}, doc = self.document, view = doc.defaultView, div, cdiv, ccdiv, fdiv, ipt, obj;div = doc.createElement("DIV");div.style.cssText = "position:absolute;width:100px;height:100px;" + "border:5px solid black;padding:5px;" + "visibility:visible;";doc.body.appendChild(div);cdiv = doc.createElement("DIV");cdiv.style.cssText = "position:absolute;width:50px;height:30px;" + "left:0px;background-color:blue;";div.appendChild(cdiv);ccdiv = doc.createElement("DIV");ccdiv.style.cssText = "width:20px;height:20px;";cdiv.appendChild(ccdiv);fdiv = doc.createElement("DIV");fdiv.style.cssText = "float:left;";div.appendChild(fdiv);if (view && view.getComputedStyle && (view.getComputedStyle(ccdiv, null).marginRight != "0px")) {supports.reliableMarginRight = false;}supports.supportCssFloat = !!fdiv.style.cssFloat;if (supports.supportCssFloat) {camelMap["float"] = "cssFloat";} else {camelMap["float"] = "styleFloat";}supports.borderBox = !(div.offsetWidth > 100);supports.borderEdg = !(cdiv.offsetLeft === 0);ipt = doc.createElement("INPUT");ipt.type = "text";ipt.style.cssText = "position:absolute;width:100px;height:100px;" + "border:2px solid;visibility:hidden;";doc.body.appendChild(ipt);supports.iptBorderBox = !(ipt.offsetWidth > 100);supports.placeholder = ("placeholder" in ipt);div.innerHTML = "";div.style.cssText = "position:absolute;left:-550px;top:-550px;" + "width:550px;height:550px;overflow:scroll;" + "visibility:hidden;";obj = this.hasScrollbar(div);supports.hscrollbar = obj.hbw;supports.vscrollbar = obj.vbw;supports.preHScrollEleH = supports.hscrollbar + (J$VM.ie ? 1 : 0);supports.preVScrollEleW = supports.vscrollbar + (J$VM.ie ? 1 : 0);supports.touchEnabled = (window.TouchEvent != undefined);supports.pointerEnabled = (window.PointerEvent != undefined);supports.mouseEnabled = (window.MouseEvent != undefined);div.innerHTML = "";div.style.cssText = "position:absolution;left:0px;top:0px;" + "width:2.54cm;height:2.54cm;visibility:hidden;";if (!window.screen.logicalXDPI) {var styles = doc.defaultView.getComputedStyle(div, null);supports.logicalXDPI = parseInt(styles["width"]);supports.logicalYDPI = parseInt(styles["height"]);} else {supports.logicalXDPI = window.screen.logicalXDPI;supports.logicalYDPI = window.screen.logicalYDPI;}obj = doc.createElement("CANVAS");supports.canvas = (typeof obj.getContext === "function");supports.svg = (doc.SVGAngle || doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure", "1.1"));div.innerHTML = "<v:shape id='vml_flag1' adj='1' />";obj = div.firstChild;obj.style.behavior = "url(#default#VML)";supports.vml = (obj ? typeof obj.adj === "object" : false);if (typeof self.Uint8Array != "function") {var script = doc.createElement("script"), head = document.getElementsByTagName("head")[0];script.type = "text/vbscript";script.text = "Function IEBinaryToString(B)\r\n" + "Dim I, S\r\n" + "For I = 1 To LenB(B)\r\n" + "If I <> 1 Then S = S & \",\"\r\n" + "S = S & CStr(AscB(MidB(B, I, 1)))\r\n" + "Next\r\n" + "IEBinaryToString = S\r\n" + "End Function\r\n";head.appendChild(script);head.removeChild(script);}if (J$VM.firefox) {Event.W3C_EVT_MOUSE_WHEEL = "DOMMouseScroll";}obj = null;doc.body.removeChild(div);doc.body.removeChild(ipt);};thi$.checkDoctype = function () {var reg = /(\"[^\"]+\")/gi, publicIDReg = /\s+(X?HTML)\s+([\d\.]+)\s*([^\/]+)*\//gi, DOCTYPEFEATURS = ["xhtml", "version", "importance"], doctype = J$VM.doctype = {declared:false}, dtype, publicId, systemId;if (document.doctype != null) {doctype.declared = true;dtype = document.doctype;doctype.name = dtype.name;publicId = dtype.publicId || "";systemId = dtype.systemId || "";} else {if (typeof document.namespaces != "undefined") {var dt = document.all[0];var value = (dt.nodeType == 8 ? dt.nodeValue : "");if (value && (value.toLowerCase().indexOf("doctype") != -1)) {doctype.declared = true;doctype.name = dt.scopeName;dtype = [];value.replace(reg, function ($0) {if ($0) {$0 = $0.replace(/"|'/g, "");dtype.push($0);}});publicId = dtype[0] || "";systemId = dtype[1] || "";}}}if (doctype.declared) {doctype.publicId = publicId = publicId.toLowerCase();doctype.systemId = systemId.toLowerCase();try {if (publicId.length > 0 && publicIDReg.test(publicId) && RegExp.$1) {doctype["xhtml"] = (RegExp.$1);doctype["version"] = RegExp.$2;doctype["importance"] = RegExp.$3;}}catch (e) {}doctype.getEigenStr = function () {var fValues = [], v;if (this.declared) {for (var i = 0, len = DOCTYPEFEATURS.length; i < len; i++) {v = this[DOCTYPEFEATURS[i]];if (v) {fValues.push(v);}}v = fValues.length > 0 ? fValues.join("-") : "";}return v;};}};thi$.createElement = function (type) {var el = document.createElement(type);return el;};thi$.cloneElement = function (ele, deep) {var view;switch (Class.typeOf(ele)) {case "htmlbodyelement":case "htmliframeelement":view = this.createElement("DIV");break;default:if (ele) {view = ele.cloneNode(deep);view.cloned = true;}break;}return view;};thi$.camelName = function (s) {var _s = camelMap[s];if (_s != undefined) {return _s;}_s = s.replace(REGX_HYPHEN, function (a, l) {return l.toUpperCase();});camelMap[s] = _s;if (_s !== s) {hyphenMap[_s] = s;}return _s;};thi$.hyphenName = function (s) {var _s = hyphenMap[s];if (_s !== undefined) {return _s;}_s = s.replace(REGX_CAMEL, function (u) {return "-" + u.toLowerCase();});hyphenMap[s] = _s;if (_s !== s) {camelMap[_s] = s;}return _s;};thi$.offsetParent = function (ele) {var p = ele.offsetParent, body = document.body;if (!p || !this.contains(body, p, true)) {p = body;}return p;};thi$.currentStyles = function (el) {var V = document.defaultView;return (V && V.getComputedStyle) ? V.getComputedStyle(el, null) : (el.currentStyle || el.style);};var OPACITYREGX = /alpha\(opacity=(.*)\)/i;thi$.getStyle = function (el, sp, currentStyle) {if (!el || el === self.document) {return null;}var out;sp = this.camelName(sp);currentStyle = currentStyle || this.currentStyles(el);out = currentStyle[sp];if (sp === "marginRight" && out !== "0px" && !J$VM.supports.reliableMarginRight) {sp = el.style.display;el.style.display = "inline-block";out = this.currentStyles(el).marginRight;el.style.display = sp;} else {if (sp === "opacity") {if (el.style.filter.match) {out = 1;sp = el.style.filter.match(OPACITYREGX);if (sp) {sp = parseFloat(sp[1]);if (!isNaN(sp)) {out = sp / 100;}}}}}return out;};thi$.getStyles = function (el, sps) {var currentStyle = this.currentStyles(el), styles = {};(function (sp) {styles[this.camelName(sp)] = this.getStyle(el, sp, currentStyle);}).$forEach(this, sps || []);return styles;};thi$.getAttribute = function (el, attr) {if (!el || el.nodeType !== 1 || !attr) {return "";}var tmp = attr.toLowerCase(), prop = tmp, v;if (J$VM.ie && parseInt(J$VM.ie) < 8) {prop = ATTRIBUTESCT[attr] || ATTRIBUTESCT[tmp] || attr;} else {prop = tmp;}if (J$VM.ie) {v = el[prop];}if (!v) {v = el.getAttribute(attr);}if (BOOLATTRREGEXP.test(tmp)) {if (el[prop] === true && v === "") {return tmp;}return v ? tmp : "";}return v ? "" + v : "";};thi$.hasAttribute = function (el, attr) {return el.hasAttribute ? el.hasAttribute(attr) : Class.isValid(el.getAttribute(attr));};thi$.setAttribute = function (el, attr, value) {if (!el || el.nodeType !== 1 || !attr) {return;}var prop = attr.toLowerCase(), v;if (J$VM.ie && parseInt(J$VM.ie) < 8) {attr = ATTRIBUTESCT[attr] || ATTRIBUTESCT[prop] || attr;} else {attr = prop;}if (BOOLATTRREGEXP.test(prop)) {if (Class.isString(value)) {v = (value.toLowerCase() === "true");} else {v = (value === true);}if (v) {el.setAttribute(attr, "" + v);} else {el.removeAttribute(attr);}return;}v = Class.isValid(value) ? "" + value : "";if (v.length > 0) {el.setAttribute(attr, v);} else {el.removeAttribute(attr);}};thi$.removeAttribute = function (el, attr) {if (!el || el.nodeType !== 1 || !attr) {return;}var prop = attr.toLowerCase();if (J$VM.ie && parseInt(J$VM.ie) < 8) {attr = ATTRIBUTESCT[attr] || ATTRIBUTESCT[prop] || attr;} else {attr = prop;}el.removeAttribute(attr);};thi$.setAttributes = function (el, attrObj) {if (!el || el.nodeType !== 1 || (typeof attrObj !== "object")) {return;}var attr;for (attr in attrObj) {this.setAttribute(el, attr, attrObj[attr]);}};thi$.setOpacity = function (el, value) {var style = el.style, currentStyle = el.currentStyle;if (J$VM.ie && parseInt(J$VM.ie) < 10) {var opacity = isNaN(value) ? "" : "alpha(opacity=" + value * 100 + ")";var filter = currentStyle && currentStyle.filter || style.filter || "";filter = filter.replace(/alpha\(opacity=(.*)\)/i, "").replace(/(^\s*)|(\s*$)/g, "");style.zoom = 1;var filterVal = new js.lang.StringBuffer();filterVal = filterVal.append(filter);filterVal = filter.length > 0 ? filterVal.append(" ") : filterVal;filterVal = filterVal.append(opacity);style.filter = filterVal.toString();} else {style.opacity = value;}};thi$.clearOpacity = function (el) {var style = el.style;if (J$VM.ie && parseInt(J$VM.ie) < 10) {var filter = style.filter;style.filter = filter ? filter.replace(/alpha\(opacity=(.*)\)/i, "").replace(/(^\s*)|(\s*$)/g, "") : "";} else {style.opacity = style["-moz-opacity"] = style["-khtml-opacity"] = "";}};var _setStyle = function (ele, sp, value) {if (sp == "opacity") {this.setOpacity(ele, value);} else {sp = this.camelName(sp);ele.style[sp] = value;}};thi$.setStyle = function (el, sp, value) {var styles = {};styles[sp] = value;this.applyStyles(el, styles);};thi$.applyStyles = function (ele, styles) {var mbpchanged = false, sp, bounds;styles = styles || {};for (sp in styles) {mbpchanged = mbpchanged || MBPTEST.test(sp);_setStyle.call(this, ele, sp, styles[sp]);}if (!this.isDOMElement(ele)) {if (mbpchanged) {delete ele.bounds;}bounds = null;} else {bounds = this.getBounds(ele, mbpchanged);}return bounds;};thi$.MBPCache = {};thi$.MBP = function (ele, nocache, clazz) {var bounds = ele ? (ele.bounds || {}) : {}, outer, mbp, mbpinline, clone, body;if (!ele) {return null;}outer = this.outerSize(ele);clazz = clazz || this.getClassName(ele);mbp = bounds.MBP;if (mbp && !nocache && (mbp.clazz === clazz) || (mbp && ele.cloned)) {if (outer.valid) {J$VM.System.objectCopy(outer, mbp);}return mbp;}mbpinline = MBPTEST.test(ele.style.cssText);if (!mbpinline) {mbp = this.MBPCache[clazz];mbp = mbp ? J$VM.System.objectCopy(mbp, {}) : null;if (mbp) {if (outer.valid) {J$VM.System.objectCopy(outer, mbp);}return mbp;}}if (this.isDOMElement(ele)) {mbp = _calcMBP.call(this, ele, clazz, outer, mbpinline);return mbp;}body = self.document.body;clone = ele.cloneNode(ele.nodeName === "SPAN" ? true : false);clone.style.cssText = [ele.style.cssText, "visibility:hidden"].join(";");body.appendChild(clone);if (this.getStyle(clone, "display") === "none") {clone.style.display = "";}outer = this.outerSize(clone);mbp = _calcMBP.call(this, clone, clazz, outer, mbpinline);mbp.fake = true;body.removeChild(clone);return mbp;};var _calcMBP = function (ele, clazz, outer, mbpinline) {var styles = this.currentStyles(ele, true), mbp = {};switch (Class.typeOf(ele)) {case "htmlinputelement":case "htmltextareaelement":mbp.BBM = J$VM.supports.iptBorderBox;break;default:mbp.BBM = J$VM.supports.borderBox;break;}var z = parseInt(styles.zIndex);mbp.zIndex = isNaN(z) ? 0 : z;margin(styles, mbp);border(styles, mbp);padding(styles, mbp);mbp.BPW = mbp.BW + mbp.PW;mbp.BPH = mbp.BH + mbp.PH;mbp.clazz = clazz;J$VM.System.objectCopy(outer, mbp);if (!mbpinline) {this.MBPCache[clazz] = J$VM.System.objectCopy(mbp, {}, true);}return mbp;};var MBPTEST = /margin|border|padding|top|right|bottom|left|width|height/;var MBPSTYLES = [{style:"borderTopStyle", border:"borderTopWidth", margin:"marginTop", padding:"paddingTop"}, {style:"borderRightStyle", border:"borderRightWidth", margin:"marginRight", padding:"paddingRight"}, {style:"borderBottomStyle", border:"borderBottomWidth", margin:"marginBottom", padding:"paddingBottom"}, {style:"borderLeftStyle", border:"borderLeftWidth", margin:"marginLeft", padding:"paddingLeft"}];var parseNumber = function (value) {var i = Class.isValid(value) ? parseInt(value) : 0;if (Class.isNumber(i)) {return i;}switch (value.toLowerCase()) {case "thin":return 1;case "medium":return 3;case "thick":return 5;default:return 0;}};var margin = function (styles, mbp) {var i, op;for (i = 0; i < 4; i++) {op = MBPSTYLES[i];mbp[op.margin] = parseNumber(styles[op.margin]);}mbp.MW = mbp.marginLeft + mbp.marginRight;mbp.MH = mbp.marginTop + mbp.marginBottom;};var border = function (styles, mbp) {var i, op, bs;for (i = 0; i < 4; i++) {op = MBPSTYLES[i];bs = styles[op.style].toLowerCase();mbp[op.border] = (!bs || bs === "none") ? 0 : parseNumber(styles[op.border]);}mbp.BW = mbp.borderLeftWidth + mbp.borderRightWidth;mbp.BH = mbp.borderTopWidth + mbp.borderBottomWidth;};var padding = function (styles, mbp) {var i, op;for (i = 0; i < 4; i++) {op = MBPSTYLES[i];mbp[op.padding] = parseNumber(styles[op.padding]);}mbp.PW = mbp.paddingLeft + mbp.paddingRight;mbp.PH = mbp.paddingTop + mbp.paddingBottom;};thi$.getBorderWidth = function (ele) {return this.MBP(ele).MBP;};thi$.getPadding = function (ele) {return this.MBP(ele).MBP;};thi$.getMargin = function (ele) {return this.MBP(ele).MBP;};thi$.getBoundRect = function (ele, rect) {var r, ftoi = Math.ceil;rect = rect || {};try {r = ele.getBoundingClientRect();}catch (x) {r = {left:0, top:0, bottom:0, right:0};}rect.left = ftoi(r.left);rect.top = ftoi(r.top);rect.bottom = ftoi(r.bottom);rect.right = ftoi(r.right);return rect;};var _computeByBody = function () {var doctype = J$VM.doctype, fValues = [], b = true, v, table;if (doctype.declared) {v = doctype.getEigenStr();if (v) {table = DOCTYPECT[v];b = table ? (table["bodysize"] || false) : false;} else {b = false;}}return b;};thi$.outerSize = function (el, rect) {rect = rect || {};if (el.tagName !== "BODY") {rect = this.getBoundRect(el, rect);rect.width = rect.right - rect.left;rect.height = rect.bottom - rect.top;} else {var r = _computeByBody.call(this) ? document.body : document.documentElement;rect.left = rect.top = 0;rect.right = rect.width = r.clientWidth;rect.bottom = rect.height = r.clientHeight;}var valid = (rect.width + rect.height) > 0, w, h;if (!valid && this.isDOMElement(el)) {w = parseInt(this.getStyle(el, "width"), 10);h = parseInt(this.getStyle(el, "height"), 10);if (w == 0 && h == 0) {valid = true;}}rect.valid = valid;rect.position = this.getStyle(el, "position");return rect;};thi$.outerWidth = function (el) {return this.outerSize(el).width;};thi$.outerHeight = function (el) {return this.outerSize(el).height;};thi$.innerSize = function (ele) {return this.getBounds(ele);};thi$.innerWidth = function (el) {return this.innerSize(el).width;};thi$.innerHeight = function (el) {return this.innerSize(el).height;};var _setSize = function (ele, w, h, bounds) {var mbp = bounds.MBP, v, changed = false, canvas = (ele.tagName === "CANVAS");if (w !== bounds.width && Class.isNumber(w)) {v = w;w = mbp.BBM ? w : w - mbp.BPW;if (w >= 0) {if (canvas) {ele.width = w;} else {ele.style.width = w + "px";}bounds.width = mbp.width = v;changed = true;}}if (h !== bounds.height && Class.isNumber(h)) {v = h;h = mbp.BBM ? h : h - mbp.BPH;if (h >= 0) {if (canvas) {ele.height = h;} else {ele.style.height = h + "px";}bounds.height = mbp.height = v;changed = true;}}return changed;};thi$.setSize = function (ele, w, h, bounds) {bounds = bounds || this.getBounds(ele);if (_setSize.call(this, ele, w, h, bounds)) {bounds = this.getBounds(ele, true);}return bounds;};thi$.absXY = function (el) {var r = this.getBoundRect(el);return {x:r.left, y:r.top};};thi$.absX = function (el) {return this.absXY(el).x;};thi$.absY = function (el) {return this.absXY(el).y;};thi$.offsetXY = function (el) {var p = this.getOffsetParent(el), mbp = (p && p != document.body) ? this.MBP(p) : {left:0, top:0, borderLeftWidth:0, borderTopWidth:0}, bounds = {absX:mbp.left, absY:mbp.top, MBP:mbp}, xy = this.absXY(el);return this.relative(xy.x, xy.y, bounds);};thi$.offsetX = function (el) {return this.offsetXY(el).x;};thi$.offsetY = function (el) {return this.offsetXY(el).y;};var _setPosition = function (ele, x, y, bounds) {var changed = false;if (x !== bounds.x && Class.isNumber(x)) {ele.style.left = x + "px";bounds.x = x;changed = true;}if (y !== bounds.y && Class.isNumber(y)) {ele.style.top = y + "px";bounds.y = y;changed = true;}return changed;};thi$.setPosition = function (ele, x, y, bounds) {bounds = bounds || this.getBounds(ele);if (_setPosition.call(this, ele, x, y, bounds)) {bounds = this.getBounds(ele, true);}return bounds;};thi$.setZ = function (ele, z, bounds) {var mbp;bounds = bounds || this.getBounds(ele);mbp = bounds.MBP;ele.style.zIndex = z;mbp.zIndex = z;return bounds;};thi$.setBounds = function (ele, x, y, w, h, bounds) {bounds = bounds || this.getBounds(ele);var changed = _setPosition.call(this, ele, x, y, bounds);changed = _setSize.call(this, ele, w, h, bounds) || changed;return changed ? this.getBounds(ele, true) : bounds;};thi$.getBounds = function (ele, nocache) {var bounds, mbp, clazz;if (!ele) {return null;}bounds = ele.bounds = (ele.bounds || {});mbp = bounds.MBP;clazz = this.getClassName(ele);if (mbp && !nocache && (mbp.clazz === clazz)) {nocache = false;} else {nocache = true;}bounds.MBP = this.MBP(ele, nocache, clazz);bounds.MBP.fake = null;bounds.BBM = bounds.MBP.BBM;bounds = _calcCoords.call(this, ele, bounds);bounds = _calcSize.call(this, ele, bounds);return this.updateBounds(ele, bounds, bounds.offsetXY);};thi$.updateBounds = function (ele, bounds, offsetxy) {offsetxy = offsetxy || this.offsetXY(ele);bounds.offsetX = offsetxy.x;bounds.offsetY = offsetxy.y;bounds.offsetWidth = ele.offsetWidth;bounds.offsetHeight = ele.offsetHeight;bounds.scrollLeft = ele.scrollLeft;bounds.scrollTop = ele.scrollTop;bounds.scrollWidth = ele.scrollWidth;bounds.scrollHeight = ele.scrollHeight;bounds.clientWidth = ele.clientWidth;bounds.clientHeight = ele.clientHeight;bounds.scroll = this.hasScrollbar(ele, bounds);return bounds;};thi$.validBounds = function (bounds) {var mbp = bounds ? bounds.MBP : null;return mbp && mbp.valid;};var _calcCoords = function (ele, bounds) {var mbp = bounds.MBP, xy, pMBP;bounds.absX = mbp.left;bounds.absY = mbp.top;bounds.offsetXY = xy = this.offsetXY(ele);bounds.offsetX = xy.x;bounds.offsetY = xy.y;bounds.x = bounds.offsetX - mbp.marginLeft;bounds.y = bounds.offsetY - mbp.marginTop;if (!this.isDOMElement(ele)) {return bounds;}if (mbp.position === "relative") {pMBP = this.MBP(this.getOffsetParent(ele));bounds.x -= pMBP.paddingLeft;bounds.y -= pMBP.paddingTop;}return bounds;};var _calcSize = function (ele, bounds) {var mbp = bounds.MBP;bounds.width = mbp.width;bounds.height = mbp.height;if (mbp.valid) {bounds.innerWidth = bounds.width - mbp.BPW;bounds.innerHeight = bounds.height - mbp.BPH;} else {bounds.innerWidth = bounds.width;bounds.innerHeight = bounds.height;}if (mbp.BBM) {bounds.styleW = bounds.width;bounds.styleH = bounds.height;} else {bounds.styleW = bounds.innerWidth;bounds.styleH = bounds.innerHeight;}return bounds;};thi$.hasScrollbar = function (el, bounds) {var mbp = (bounds || this.getBounds(el)).MBP, vbw = el.offsetWidth - el.clientWidth - mbp.BW, hbw = el.offsetHeight - el.clientHeight - mbp.BH;return {vbw:vbw, hbw:hbw, vscroll:vbw > 1, hscroll:hbw > 1};};thi$.removeFun = function (el) {if (!el) {return;}if (el.nodeType == 1) {var handlers = el.__handlers__, eventType;if (handlers) {for (eventType in handlers) {Event.detachEvent(el, eventType);}}el.__handlers__ = undefined;el.bounds = undefined;}var a = el.attributes, i, l, n;if (a) {for (i = a.length - 1; i >= 0; i--) {n = a[i].name;if (typeof el[n] === "function") {el[n] = null;}}}a = el.childNodes;if (a) {for (i = 0, l = a.length; i < l; i++) {arguments.callee(a.item(i));}}};thi$.remove = function () {var p;return function (el, gc) {if (!el) {return;}if (gc) {this.removeFun(el);if (Class.typeOf(el) != "htmlbodyelement") {p = p || document.createElement("DIV");p.appendChild(el);p.innerHTML = "";}}if (el.parentNode) {el.parentNode.removeChild(el);}};}();thi$.removeFrom = function (el, parentNode) {if (!el) {return;}parentNode = parentNode || el.parentNode;parentNode.removeChild(el);};thi$.empty = function (el) {if (!el) {return;}while (el.firstChild) {this.remove(el.firstChild, true);}if (el.options && el.tagName === "SELECT") {el.options.length = 0;}};thi$.appendTo = function (el, parentNode) {if (!el || !parentNode) {return;}parentNode.appendChild(el);_fireHtmlEvent.call(this, el, Event.SYS_EVT_ELE_APPEND);};thi$.insertBefore = function (el, refNode, parentNode) {if (!el || (!refNode && !parentNode)) {return;}if (refNode) {refNode.parentNode.insertBefore(el, refNode);} else {parentNode.appendChild(el);}_fireHtmlEvent.call(this, el, Event.SYS_EVT_ELE_APPEND);};thi$.insertAfter = function (el, refNode) {if (!el || !refNode) {return;}var parentNode = refNode.parentNode;refNode = refNode.nextSibling;if (refNode) {parentNode.insertBefore(el, refNode);} else {parentNode.appendChild(el);}_fireHtmlEvent.call(this, el, Event.SYS_EVT_ELE_APPEND);};var _fireHtmlEvent = function (el, type) {if (!this.isDOMElement(el)) {return;}var desktop = J$VM.Runtime.getDesktop(), event;if (desktop) {event = new js.util.Event(type);event.srcElement = el;event.setEventTarget(this.getComponent(el));desktop.fireHtmlEvent(event);}};thi$.contains = function (el, child, containSelf) {if (!el || !child) {return false;}if (el.compareDocumentPosition) {var res = el.compareDocumentPosition(child);if (containSelf && res === 0) {return true;} else {return res === 20;}} else {if (containSelf && el === child) {return true;} else {return el.contains(child);}}};thi$.isDOMElement = function (el) {return this.contains(document.body, el, true);};thi$.toCssText = function (styles) {if (!Class.isObject(styles)) {return "";}var p, v, ret = [];for (p in styles) {if (styles.hasOwnProperty(p)) {v = styles[p];p = this.hyphenName(p);ret.push(p, ":", v, ";");}}return ret.join("");};thi$.joinMapToCssText = function (styleMap) {var HashMap = Class.forName("js.util.HashMap"), buf, keys, p, v;if (!styleMap || !(styleMap instanceof HashMap)) {return "";}buf = new js.lang.StringBuffer();keys = styleMap.keys();for (var i = 0, len = keys.length; i < len; i++) {p = keys[i];v = styleMap.get(p);if (v !== null && v !== undefined) {p = this.hyphenName(p);buf.append(p).append(":").append(v).append(";");}}return buf.toString();};thi$.parseCssText = function (css) {var String = js.lang.String, styleMap = new (Class.forName("js.util.HashMap"))(), frags, len, tmp, style, value;if (!Class.isString(css) || css.length == 0) {return styleMap;}frags = css.split(";");len = Class.isArray(frags) ? frags.length : 0;for (var i = 0; i < len; i++) {tmp = frags[i];tmp = tmp ? tmp.split(":") : null;if (Class.isArray(tmp)) {style = tmp[0];value = tmp[1];if (Class.isString(style) && style.length > 0) {style = style.trim();value = (Class.isString(value)) ? value.trim() : "";if (style) {styleMap.put(style, value);}}}}return styleMap;};thi$.rmStyleFromCssText = function (css, style) {if (!Class.isString(css) || css.length == 0 || !Class.isString(style) || style.length == 0) {return css;}var styleMap = this.parseCssText(css);if (!styleMap.contains(style)) {style = this.hyphenName(style);}styleMap.remove(style);return this.joinMapToCssText(styleMap);};thi$.getStringSize = function (str, txtStyles, wordwrap, width) {if (!Class.isString(str) || str.length == 0) {return {width:0, height:0};}var System = J$VM.System, textNode, s, sp, styles = {position:"absolute", left:"-10000px", top:"-10000px", display:"inline", width:"auto", height:"auto", padding:"0px", border:"0px none"};if (wordwrap === true && width > 0) {styles["white-space"] = "nomal";styles["width"] = width + "px";} else {wordwrap = false;styles["white-space"] = "nowrap";}txtStyles = txtStyles || {};for (sp in txtStyles) {if (!styles[sp] && !sp.match(/[wW]idth|margin|border|padding/)) {styles[sp] = txtStyles[sp];}}textNode = this.createElement("SPAN");textNode.style.cssText = this.toCssText(styles);textNode.innerHTML = js.lang.String.encodeHtml(str, undefined, wordwrap);this.appendTo(textNode, document.body);s = this.outerSize(textNode);this.remove(textNode, true);textNode = null;if (J$VM.ie) {s.width += 1;}return s;};thi$.getTextSize = function (ele, wordwrap, width) {var tagName = ele ? ele.tagName : null, str, styles;switch (tagName) {case "DIV":case "SPAN":str = ele.textContent ? ele.textContent : ele.innerText;break;case "INPUT":case "TEXTAREA":str = ele.value;break;default:break;}if (!Class.isValid(str)) {return {width:0, height:0};}styles = this.getStyles(ele, textSps);return this.getStringSize(str, styles, wordwrap, width);};thi$.setHTML = function (el, html) {if (J$VM.ie) {while (el.firstChild) {el.removeChild(el.firstChild);}try {el.innerHTML = "<br />" + html;el.removeChild(el.firstChild);}catch (e) {var tempDiv = this.create("div");tempDiv.innerHTML = "<br />" + html;var children = tempDiv.childNodes, len = children ? children.length : 0;for (var i = 1; i < len; i++) {el.appendChild(children[i]);}}} else {el.innerHTML = html;}return el;};thi$.getAbsoluteUrl = function () {var a;return function (url) {if (!a) {a = document.createElement("a");}a.href = url;return a.href;};}();thi$.addStyle = function (css, doc) {doc = doc || document;if (!css || !doc) {return;}var head = doc.getElementsByTagName("head")[0], styleElements = head.getElementsByTagName("style"), styleElement, media, tmpEl;if (styleElements.length == 0) {if (J$VM.ie) {doc.createStyleSheet();} else {tmpEl = doc.createElement("style");tmpEl.setAttribute("type", "text/css");head.appendChild(tmpEl);}styleElements = head.getElementsByTagName("style");}styleElement = styleElements[0];media = styleElement.getAttribute("media");if (media != null && !/screen/.test(media.toLowerCase())) {styleElement.setAttribute("media", "screen");}if (J$VM.ie) {styleElement.styleSheet.cssText += css;} else {if (J$VM.firefox) {styleElement.innerHTML += css;} else {styleElement.appendChild(doc.createTextNode(css));}}};thi$.styleSheets = {};thi$.getStyleSheetBy = function (id, href) {id = id || null;href = href || null;var key = id + ":" + href, styleEle, dom = self.document, styleSheet = this.styleSheets[key];if (styleSheet) {return styleSheet._syncUpdate();}styleSheet = this._findNativeStyleSheet(id, href);if (!styleSheet) {if (href) {styleEle = dom.createElement("link");styleEle.href = href;styleEle.rel = "stylesheet";styleEle.type = "text/css";} else {styleEle = dom.createElement("style");if (id) {styleEle.id = id;}styleEle.type = "text/css";}this.insertBefore(styleEle, dom.getElementById("j$vm"));styleSheet = this._findNativeStyleSheet(id, href);}styleSheet = this.styleSheets[key] = new (Class.forName("js.util.StyleSheet"))(styleSheet);return styleSheet;};thi$.rmvStyleSheetBy = function (id, href) {id = id || null;href = href || null;var key = id + ":" + href, styleEle, dom = self.document, styleSheet = this.styleSheets[key];if (styleSheet) {this.removeFrom(styleSheet.nativeSheet.ownerNode);styleSheet.destroy();delete this.styleSheets[key];} else {styleSheet = this._findNativeStyleSheet(id, href);if (styleSheet) {this.removeFrom(styleSheet.ownerNode);}}};thi$._findNativeStyleSheet = function (id, href) {id = id || null;href = href || null;var styleSheets = self.document.styleSheets, styleSheet, styleEle, ret = [];for (var i = 0, len = styleSheets.length; i < len; i++) {styleSheet = styleSheets[i];styleEle = this.getStyleSheetElement(styleSheet);if (!styleEle || (id && styleEle.id !== id) || (href && styleSheet.href !== href)) {continue;}ret.push(styleSheet);}return ret.length > 0 ? ret[ret.length - 1] : null;};thi$.getStyleSheetElement = function (sheet) {return sheet ? (sheet.ownerNode || sheet.owningElement) : null;};thi$.setClassName = function (ele, className, prefix) {if (!ele) {return;}if (!Class.isString(prefix)) {prefix = "jsvm--";}switch (Class.typeOf(ele)) {case "htmlinputelement":case "htmltextareaelement":prefix = prefix ? prefix + "txt" : "";break;default:prefix = prefix ? prefix + "com" : "";break;}ele.className = [prefix, className].join(" ");};thi$.getClassName = function (ele) {var clazz, name;if (!Class.isHtmlElement(ele)) {clazz = ele.uuid = (ele.uuid || js.lang.Math.uuid());} else {clazz = this.splitClassName(ele.className).join(" ");}return clazz;};var STATEREG = /(\w+)(_\d{1,4})$/;thi$.splitClassName = function (className) {className.trim();var names = className.split(" "), map = {}, ret = [], name;while (names.length > 0) {name = names.shift();if (STATEREG.test(name)) {name = RegExp.$1;}if (!map[name]) {ret.push(name);}}return ret;};var _combineClassName = function (className, ext, separator) {if (!Class.isString(separator)) {separator = "_";}var names = this.splitClassName(className), rst = [], name, tmp;for (var i = 0, len = names.length; i < len; i++) {name = names[i].trim();if (!name || name.indexOf("--") !== -1) {continue;}for (var j = 0, jlen = ext.length; j < jlen; j++) {tmp = ext[j].trim();if (tmp) {rst.push(name + separator + tmp);} else {rst.push(name);}}}return rst.join(" ");};var STATESEGREG = /\s+\$(\S+)/g;thi$.combineClassName = function (className, ext, separator) {if (!Class.isArray(ext)) {if (Class.isValid(ext)) {ext = "" + ext;}if (ext) {ext = [ext];} else {ext = [];}}if (className && ext.length > 0) {className = _combineClassName.apply(this, arguments);}return className;};thi$.stateClassName = function (className, state) {var names = [], stateNames = [], sname, str = className.replace(STATESEGREG, function (match, name) {if (name) {stateNames.push(name);}return "";});names = this.splitClassName(str);if (stateNames.length === 0) {for (var i = names.length - 1; i >= 0; i--) {sname = names[i];if (!sname || sname.indexOf("--") !== -1) {continue;} else {stateNames.push(sname);break;}}}if (!isNaN(state) && state != 0) {for (var i = 0, len = stateNames.length; i < len; i++) {names.push(stateNames[i] + "_" + state);}}return names.join(" ");};thi$.extractDOMClassName = function (className) {return className ? className.replace(STATESEGREG, "") : "";};thi$.makeUrlPath = function (parent, file) {var A = self.document.createElement("A");A.href = parent + file;return A.href;};thi$.getEntryID = function (ele) {var entries = self.document.querySelectorAll("[jsvm_entry]"), entry, ret;if (!ele) {ret = (entries && entries.length > 0) ? entries[0].getAttribute("jsvm_entry") : ret;} else {for (var i = 0, len = entries.length; i < len; i++) {entry = entries[i];if (this.contains(entry, ele, true)) {ret = entry.getAttribute("jsvm_entry");break;}}}return ret;};thi$.getComponent = function (ele, create, def, Runtime) {var obj = null, uuid, idx, parent, peer;if (!ele || ele === self || ele === self.document) {return obj;}uuid = ele.uuid;if (uuid) {idx = uuid.lastIndexOf("-cover");if (idx != -1) {peer = this.getObject(uuid.substring(0, idx));if (peer) {obj = {isMovable:function () {return false;}, isResizable:function () {return false;}, fireEvent:function (e, b) {e.onCover = true;e.setEventTarget(peer);peer.fireEvent(e, b);}};}} else {idx = uuid.lastIndexOf("-capture");obj = this.getObject(uuid.substring(0, idx));}if (!obj) {obj = this.getObject(uuid);}} else {if (create) {def = def || {};def.id = ele.id;def.stateless = Class.isBoolean(def.stateless) ? def.stateless : true;def.className = def.className || ele.className;Runtime = Runtime || function () {var comp = this.getComponent(ele.parentNode);return comp ? comp.Runtime() : null;}.call(this);obj = new js.awt.Component(def, Runtime, ele);var bounds = obj.getBounds();obj.setBounds(bounds.x, bounds.y, bounds.width, bounds.height, 4);} else {obj = this.getComponent(ele.parentNode);}}return obj;};thi$.getComponentById = function (id) {return this.getComponent(self.document.getElementById(id));};thi$.getOffsetParent = function (ele) {if (ele !== document.body) {ele = ele.offsetParent;if (!ele || ele === document) {ele = document.body;}}return ele;};thi$.inside = function (x, y, bounds) {var mbp = bounds.MBP, minX, minY, maxX, maxY;minX = bounds.absX + mbp.borderLeftWidth;maxX = minX + bounds.clientWidth;minY = bounds.absY + mbp.borderTopWidth;maxY = minY + bounds.clientHeight;return x > minX && x < maxX && y > minY && y < maxY;};thi$.relative = function (x, y, bounds) {var mbp = bounds.MBP;return {x:x - bounds.absX - mbp.borderLeftWidth, y:y - bounds.absY - mbp.borderTopWidth};};var OFFSETTABLE = [[0, 7, 6], [1, 8, 5], [2, 3, 4]];var STEP = 10, STEP3 = STEP * 3;var offsetIndex0 = function (offset, min, max) {var diff = max - min, step = diff >= STEP3 ? STEP : Math.floor(diff / 3);if (offset < min + step) {return 0;} else {if (offset > max - step) {return 2;} else {return 1;}}};thi$.offsetIndexes = function (x, y, bounds) {var xIdx, yIdx;yIdx = offsetIndex0(y, bounds.absY, bounds.absY + bounds.height);xIdx = offsetIndex0(x, bounds.absX, bounds.absX + bounds.width);return [yIdx, xIdx, OFFSETTABLE[yIdx][xIdx]];};var CURSORS = ["nw-resize", "w-resize", "sw-resize", "s-resize", "se-resize", "e-resize", "ne-resize", "n-resize", "move", "ew-resize", "ns-resize", "default", "pointer"];var capturer;var _checkCapturer = function () {if (capturer) {return;}capturer = document.createElement("div");capturer.id = "mouse-capturer";capturer.style.cssText = "position:absolute;";capturer.style.backgroundColor = "blue";};thi$.showMouseCapturer = function (bounds, uuid, spot) {_checkCapturer();if (!bounds) {this.setBounds(capturer, 0, 0, 0, 0);return;}capturer.style.cursor = CURSORS[spot];capturer.uuid = [uuid, "-capture"].join("");capturer.spot = spot;document.body.appendChild(capturer);this.setBounds(capturer, bounds.x, bounds.y, bounds.width, bounds.height);this.setZ(capturer, this.LM_ZBASE);};thi$.isMouseCapture = function (ele) {return ele === capturer;};thi$.DM_ZBASE = 1000;thi$.LM_ZBASE = 10000;thi$.setCursor = function (ele, cursor) {if (!ele) {return;}ele.style.cursor = cursorOf(cursor);};thi$.getCursor = function (ele) {return ele ? ele.style.cursor : null;};var cursorOf = function (index) {var ret;if (Class.isString(index)) {ret = index;} else {if (Class.isNumber(index)) {ret = index >= 0 ? CURSORS[index] : null;}}return ret;};var dirtys = {};thi$.setDynamicCursor = function (ele, cursor) {if (!ele) {return;}var did = ele.did = (ele.did || Math.uuid());if (!dirtys[did]) {dirtys[did] = {cursor:this.getCursor(ele), ele:ele};}this.setCursor(ele, cursor);};thi$.cleanDynamicCursor = function () {var data, p;for (p in dirtys) {data = dirtys[p];if (data && data.ele) {this.setCursor(data.ele, data.cursor);}}dirtys = {};};thi$.getMaxZIndex = function (ele) {var children = ele.children, zIndex = 0, tmp, e;for (var i = 0, len = children.length; i < len; i++) {e = children[i];tmp = parseInt(this.currentStyles(e, true).zIndex);tmp = Class.isNumber(tmp) ? tmp : 0;zIndex = Math.max(zIndex, tmp);}return zIndex;};thi$.isInScrollbar = function (x, y, ele, bounds) {bounds = bounds || this.getBounds(ele);var sobj = this.hasScrollbar(ele), MBP = bounds.MBP, tx, ty, b = false;if (sobj.vscroll) {tx = bounds.absX + bounds.width - MBP.borderRightWidth - MBP.paddingRight;b = x >= (tx - sobj.vbw) && x <= tx && y >= bounds.absY && y <= (bounds.absY + bounds.height);}if (!b && sobj.hscroll) {ty = bounds.absY + bounds.height - MBP.borderBottomWidth - MBP.paddingBottom;b = x >= bounds.absX && x <= (bounds.absX + bounds.width) && y >= (ty - sobj.hbw) && y <= ty;}return b;};}.$extend(js.lang.Object);

$package("js.util");$import("js.util.HashMap");js.util.MemoryStorage = function (capacity) {var CLASS = js.util.MemoryStorage, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;var Class = js.lang.Class;thi$.isMemory = true;thi$.length = function () {return this.size();};thi$.key = function (index) {return this._keys[index];};thi$.setItem = function (key, value) {if (this.size() >= this.capacity) {_reduce.call(this);}this.put(key, {key:key, count:1, data:value});};thi$.getItem = function (key) {var ele = this.get(key), ret;if (ele) {ele.count++;ret = ele.data;}return ret;};thi$.removeItem = function (key) {var o = this.remove(key);return o ? o.data : undefined;};var _reduce = function () {var array = this.values().sort(function (a, b) {return a.count - b.count;}), len = Math.floor(this.capacity / 10), tmp;len = len < 1 ? 1 : len;while (len > 0) {tmp = array.shift();this.removeItem(tmp.key);len--;}};thi$._init = function (capacity) {arguments.callee.__super__.call(this);this.capacity = Class.isNumber(capacity) ? capacity : 1024;}.$override(this._init);this._init.apply(this, arguments);}.$extend(js.util.HashMap);

$package("js.util");js.util.Storage = function (storage) {var CLASS = js.util.Storage, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;var Class = js.lang.Class;var _check = function () {var hasStorage = (this._storage != null && this._storage != undefined);if (arguments.length > 0) {var key = arguments[0];if (typeof key === "string" && key.length > 0) {return hasStorage;} else {return false;}}return hasStorage;};thi$.keys = function () {var keys = [];if (!this._storage.isMemory) {for (var i = 0, len = this.length(); i < len; i++) {keys[i] = this._storage.key(i);}} else {keys = this._storage.keys();}return keys;};thi$.length = function () {var sto = this._storage;return _check() ? (sto.isMemory ? sto.size() : sto.length) : 0;};thi$.key = function (index) {return _check() ? this._storage.key(index) : undefined;};thi$.setItem = function (key, value) {if (!_check.call(this, key)) {return;}var sto = this._storage;sto.removeItem(key);switch (Class.typeOf(value)) {case "string":case "number":sto.setItem(key, value);break;case "object":case "array":if (sto.isMemory) {sto.setItem(key, value);} else {sto.setItem(key, JSON.stringify(value));}break;default:break;}};thi$.getItem = function (key) {if (!_check.call(this, key)) {return null;}var value = this._storage.getItem(key);if (value) {if (Class.typeOf(value) == "string" && (value.indexOf("{") == 0 || value.indexOf("[") == 0)) {value = JSON.parse(value);}}return value;};thi$.removeItem = function (key) {if (!_check.call(this, key)) {return;}this._storage.removeItem(key);};thi$.clear = function () {if (!_check.call(this)) {return;}this._storage.clear();};thi$._init = function (storage) {this._storage = storage;};this._init.apply(this, arguments);}.$extend(js.lang.Object);js.util.Storage.getStorage = function (type) {var _storage, _storageObj;switch (type) {case "local":try {_storage = window.localStorage;}catch (x) {}break;case "session":try {_storage = window.sessionStorage;}catch (e) {}break;case "memory":default:_storage = new js.util.MemoryStorage();break;}_storageObj = new js.util.Storage(_storage || new js.util.MemoryStorage());return _storageObj;};js.util.Cache = function () {var CLASS = js.util.Cache, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;var local, session, memory;thi$.setItem = function (key, value) {try {local.setItem(key, value);}catch (e1) {try {session.setItem(key, value);}catch (e2) {memory.setItem(key, value);}}};thi$.getItem = function (key) {var value = memory.getItem(key);value = value ? value : session.getItem(key);value = value ? value : local.getItem(key);return value;};thi$._init = function () {local = J$VM.storage.local;session = J$VM.storage.session;memory = J$VM.storage.memory;};this._init.apply(this, arguments);}.$extend(js.lang.Object);

$package("js.util");js.util.Cookie = function (k, v, e, p, d, s) {var CLASS = js.util.Cookie, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;thi$.getName = function () {return this._name;};thi$.getValue = function () {return this._value;};thi$.setValue = function (v) {this._value = v;};thi$.getMaxAge = function () {return this._maxAge;};thi$.setMaxAge = function (expiry) {this._maxAge = (typeof expiry === "number" && !isNaN(expiry)) ? expiry * 1000 : undefined;};thi$.getPath = function () {return this._path;};thi$.setPath = function (uri) {this._path = (typeof uri === "string") ? uri : "/";};thi$.getDomain = function () {return this._domain;};thi$.setDomain = function (pattern) {this._domain = (typeof pattern === "string") ? pattern.toLowerCase() : undefined;};thi$.setSecure = function (s) {this._secure = (s === true) ? true : undefined;};thi$.toString = function () {var buf = new js.lang.StringBuffer();buf.append(this._name).append("=").append(this._value ? escape(this._value) : "");if (typeof this._maxAge === "number") {var exp = new Date();exp.setTime(exp.getTime() + this._maxAge);buf.append(";expire=").append(exp.toGMTString());}if (this._path) {buf.append(";path=").append(this._path);}if (this._domain) {buf.append(";domain=").append(this._domain);}if (this._secure === true) {buf.append(";secure").append(this._secure);}return buf.toString();};thi$._init = function (k, v, e, p, d, s) {this._name = k;this.setValue(v);this.setMaxAge(e);this.setPath(p);this.setDomain(d);};this._init.apply(this, arguments);}.$extend(js.lang.Object);

$package("js.util");$import("js.util.Cookie");js.util.CookieStorage = function () {var CLASS = js.util.CookieStorage, thi$ = CLASS.prototype;if (CLASS.__defined__) {this.parseCookies();return;}CLASS.__defined__ = true;var cookies;thi$.setCookie = function (name, value, expire, path, domain, secure) {this.add(new js.util.Cookie(name, value, expire, path, domain, secure));};thi$.getCookie = function (name) {var cookie = this.get(name);return cookie ? cookie.getValue() : undefined;};thi$.delCookie = function (name) {var cookie = this.get(name);if (cookie) {this.remove(cookie);}};thi$.add = function (cookie, uri) {document.cookie = cookie.toString();this.parseCookies();};thi$.get = function (name) {return cookies[name];};thi$.remove = function (cookie, uri) {cookie.setMaxAge(-1);this.add(cookie, uri);};thi$.parseCookies = function () {cookies = cookies || {};for (var p in cookies) {delete cookies[p];}var vs = document.cookie.split(";"), item, n, v;for (var i = 0, len = vs.length; i < len; i++) {item = vs[i].split("=");n = item[0].trim();v = unescape(item[1]);cookies[n] = new js.util.Cookie(n, v);}};this.parseCookies();}.$extend(js.lang.Object);

$package("js.util");js.util.Locale = function (language, country) {var CLASS = js.util.Locale, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;var C = js.lang.Class, System = J$VM.System;CLASS.getSymbols = function (locale, type) {var res, symbols;if (locale && (locale instanceof CLASS)) {res = C.forName("js.text.resources." + locale.toString());if (C.isString(type)) {symbols = res ? res[type] : null;} else {symbols = res;}}return symbols;};CLASS.getDateSymbols = function (locale) {return CLASS.getSymbols(locale, "dateSymbols");};CLASS.getNumberSymbols = function (locale) {return CLASS.getSymbols(locale, "numrSymbols");};thi$.setLanguage = function (language) {this.language = C.isString(language) ? language : "";};thi$.getLanguage = function () {return this.language ? this.language.toLowerCase() : "";};thi$.setCountry = function (country) {this.country = C.isString(country) ? country : "";};thi$.getCountry = function () {return this.country ? this.country.toUpperCase() : "";};thi$.equals = function (locale) {return locale && (locale.getLanguage() === this.getLanguage()) && (locale.getCountry() === this.getCountry());};thi$.toString = function () {var language = this.getLanguage(), country = this.getCountry();return [language, country].join(country ? "_" : "");};thi$._init = function (language, country) {if (!C.isString(language) && !C.isString(country)) {var nav = self.navigator, lang = nav.browserLanguage || nav.language;lang = lang.replace("-", "_").split("_");language = lang[0];country = lang.length > 1 ? lang[1] : "";}this.setLanguage(language);this.setCountry(country);};this._init.apply(this, arguments);};

$package("js.util");js.util.Base64 = new function () {this.safeB64 = "ABCDEFGHIJKLMNOP" + "QRSTUVWXYZabcdef" + "ghijklmnopqrstuv" + "wxyz0123456789@*" + "-";this.standardB64 = "ABCDEFGHIJKLMNOP" + "QRSTUVWXYZabcdef" + "ghijklmnopqrstuv" + "wxyz0123456789+/" + "=";var utf8_ucs2 = function (s) {if (!s) {return null;}var len = s.length;if (len == 0) {return "";}var d = [], c = 0, i = 0, tmp = 0;while (i < len) {c = s[i++];if ((c & 224) == 224) {tmp = (c & 15) << 12;c = s[i++];tmp |= ((c & 63) << 6);c = s[i++];tmp |= (c & 63);} else {if ((c & 192) == 192) {tmp = (c & 31) << 6;c = s[i++];tmp |= (c & 63);} else {tmp = c;}}d.push(String.fromCharCode(tmp));}return d.join("");};var ucs2_utf8 = function (s) {if (!s) {return null;}var d = [];if (s == "") {return d;}var c = 0, i = 0, j = 0, len = s.length;while (i < len) {c = s.charCodeAt(i++);if (c <= 127) {d[j++] = c;} else {if ((c >= 128) && (c <= 2047)) {d[j++] = ((c >> 6) & 31) | 192;d[j++] = (c & 63) | 128;} else {d[j++] = (c >> 12) | 224;d[j++] = ((c >> 6) & 63) | 128;d[j++] = (c & 63) | 128;}}}return d;};this.encode = function (s, table) {return (!s || s.length == 0) ? s : this.encodeArray(ucs2_utf8.call(this, s), table);};this.encodeArray = function (array, table) {var d = [], b = array, len = b.length, b0, b1, b2, b3, i = 0, tmp;table = table || this.safeB64;while (i < len) {tmp = b[i++];b0 = (tmp & 252) >> 2;b1 = (tmp & 3) << 4;if (i < len) {tmp = b[i++];b1 |= (tmp & 240) >> 4;b2 = (tmp & 15) << 2;if (i < len) {tmp = b[i++];b2 |= (tmp & 192) >> 6;b3 = tmp & 63;} else {b3 = 64;}} else {b2 = b3 = 64;}d.push(table.charAt(b0));d.push(table.charAt(b1));d.push(table.charAt(b2));d.push(table.charAt(b3));}return d.join("");};this.decode = function (s, table) {if (!s) {return null;}var len = s.length;if (len % 4 != 0) {throw new Error(s + " is not a valid Base64 string.");}return utf8_ucs2.call(this, this.decodeArray(s, table));};this.decodeArray = function (s, table) {table = table || this.safeB64;var b = [], i = 0, j = 0, e = 0, len = s.length, c, tmp;while (i < len) {c = table.indexOf(s.charAt(i++));tmp = c << 18;c = table.indexOf(s.charAt(i++));tmp |= c << 12;c = table.indexOf(s.charAt(i++));if (c < 64) {tmp |= c << 6;c = table.indexOf(s.charAt(i++));if (c < 64) {tmp |= c;} else {e = 1;}} else {e = 2;i++;}b[j + 2] = tmp & 255;tmp = (tmp >> 8);b[j + 1] = tmp & 255;tmp = (tmp >> 8);b[j + 0] = tmp & 255;j += 3;}b.splice(b.length - e, e);return b;};}();

$package("js.net");js.net.URI = function (url) {var CLASS = js.net.URI, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;var Keys = ["source", "scheme", "userInfo", "user", "password", "host", "port", "path", "query", "fragment"], schemeRegExp = /^(?:([-+a-zA-Z0-9]+):\/\/|\/\/)/i, userInfoRegExp = /^(?:([^:@\/?\s]+))(:(?:[^:@\/?\s]+))?@/i, hostRegExp = /^((?:[^;:@=\/\?\.\s]+\.)+[A-Za-z0-9\-]{1,}|localhost)/i, regNameRegExp = /^([^;:@=\/\?\#\.\s]+)/i, noSchemeRegNameRegExp = /^([^;:@=\/\?\#\.\s]+)(?=:\d+)/i, portRegExp = /^:(\d+)/, pathRegExp = /^\.*\/[^?#]*/i, queryRegExp = /^\?([^#]*)/i, fragmentRegExp = /^#(.+)/i, QueryRegExp = new RegExp("(?:^|&)([^&=]*)=?([^&]*)", "g"), regExps = [schemeRegExp, userInfoRegExp, hostRegExp, portRegExp, pathRegExp, queryRegExp, fragmentRegExp], REGX_PATH = /(.*[/|\\])(.*)/;thi$.parseURI = function (uri) {if (!uri) {return;}var curUri = uri, regExp, i = 0, parseFun = function ($0, $1, $2, $3) {switch (regExp) {case schemeRegExp:this.scheme = $1;break;case userInfoRegExp:this.userInfo = $0;this.user = $1;this.password = $2 ? $2.substring(1) : $2;break;case hostRegExp:case regNameRegExp:case noSchemeRegNameRegExp:this.host = $0;break;case portRegExp:this.port = $1;break;case pathRegExp:this.path = $0;break;case queryRegExp:this.query = $1;break;case fragmentRegExp:this.fragment = $1;break;default:break;}return "";}.$bind(this);while (curUri && i < 7) {regExp = regExps[i];curUri = curUri.replace(regExp, parseFun);if (regExp == hostRegExp && !this.host) {regExp = this.scheme ? regNameRegExp : noSchemeRegNameRegExp;curUri = curUri.replace(regExp, parseFun);}++i;}if (curUri && (curUri.search(/\?#/i) == -1) && this.path == undefined && this.query == undefined && this.fragment == undefined) {this.path = curUri;}this.source = uri;};thi$.parseParams = function (query) {var params = {};if (query) {query.replace(QueryRegExp, function ($0, $1, $2) {if ($1) {params[$1] = $2;}});}return params;};thi$.toURI = function () {var curUri = J$VM.System.getProperty("j$vm_uri") || new (CLASS)(document.URL), uri = "", query = "", hasQF = false, tmp;if (this.host) {uri += (this.scheme || "http") + "://";uri += this.userInfo || "";uri += this.host;if (this.port) {uri += ":" + this.port;}if (this.path) {uri += this.path;hasQF = true;}} else {if (this.path) {uri += curUri.scheme + "://" + (curUri.userInfo || "") + curUri.host;if (curUri.port) {uri += ":" + curUri.port;}if (this.path.indexOf("/") == 0) {uri += this.path;} else {tmp = (curUri.path || "").match(REGX_PATH);uri += (tmp[1] || "/") + this.path;}hasQF = true;}}if (hasQF) {for (var key in this.params) {query += key + "=" + this.params[key] + "&";}if (query) {query = query.substring(0, query.length - 1);uri += "?" + query;}if (this.fragment) {uri += "#" + this.fragment;}}return uri;};thi$.isSameOrigin = function (s) {var uri = new (CLASS)(s || document.URL);return this.scheme == uri.scheme && this.host == uri.host && this.port == uri.port;};thi$._init = function () {if (arguments.length === 1) {this.scheme = undefined;this.userInfo = undefined;this.user = undefined;this.password = undefined;this.host = undefined;this.port = undefined;this.path = undefined;this.query = undefined;this.fragment = undefined;var A, uri = "";try {uri = arguments[0];while (uri.indexOf("%") > 0) {uri = unescape(uri);}uri = decodeURI(uri);if (J$VM.env.j$vm_isworker !== true) {A = document.createElement("A");A.href = uri;uri = A.href;}}catch (ex) {throw ex;}this.parseURI(uri);} else {this.scheme = arguments[0];this.userInfo = arguments[1];this.host = arguments[2];this.port = arguments[3];this.path = arguments[4];this.query = arguments[5];this.fragment = arguments[6];}this.params = this.parseParams(this.query);};this._init.apply(this, arguments);}.$extend(js.lang.Object);

$package("js.net");js.net.XHRPROVIDER = {progid:undefined, progids:["MSXML2.XMLHTTP.6.0", "MSXML2.XMLHTTP", "Microsoft.XMLHTTP"]};js.net.XHRPool = new function () {J$VM.XHRPool = this;this.pool = [];var Class = js.lang.Class, Q = [], running = false;this.getXHR = function (isAsync) {var xhr, i, len, pool = this.pool, ie = (J$VM.ie !== undefined), Connection = Class.forName("js.net.HttpURLConnection"), max = J$VM.System.getProperty("j$vm_ajax_concurrent", 8);for (i = 0, len = pool.length; i < len; i++) {xhr = pool[i];if (!xhr.isOccupy() && !ie) {break;} else {xhr = undefined;}}if (!xhr) {if (!isAsync || max < 0 || this.pool.length < max) {xhr = new Connection(isAsync);if (!ie) {pool.push(xhr);}} else {xhr = (!ie) ? new Connection(isAsync, true) : new Connection(isAsync);}}xhr.setAsync(isAsync);xhr.occupy();return xhr;};this.getQ = function () {return Q;};this.post = function (req) {Q.push(req);if (!running) {_schedule(0);}};var _schedule = function (delay) {if (Q.length == 0) {running = false;} else {running = true;_dispatch.$delay(this, delay);}}.$bind(this);var _dispatch = function () {var xhr = this.getXHR(true), req, data;if (xhr.isBlocking()) {_schedule(100);return;}req = Q.shift();req._xhr = xhr._xhr;req._blocking = false;req.xhr = xhr;data = req.data;req.open(data.method, data.url, data.params, data.withOutCookie);_schedule(100);}.$bind(this);var _init = function () {_schedule(0);}.call(this);}();js.net.HttpURLConnection = function (isAsync, blocking) {var CLASS = js.net.HttpURLConnection, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init(isAsync, blocking);return;}CLASS.__defined__ = true;var Class = js.lang.Class, Event = js.util.Event, PV = js.net.XHRPROVIDER;thi$.isAsync = function () {return this._async || false;};thi$.setAsync = function (isAsync) {this._async = isAsync || false;if (this._async) {this.declareEvent(Event.SYS_EVT_SUCCESS);this.declareEvent(Event.SYS_EVT_HTTPERR);} else {delete this["on" + Event.SYS_EVT_SUCCESS];delete this["on" + Event.SYS_EVT_HTTPERR];}};thi$.isNoCache = function () {return this._nocache || false;};thi$.setNoCache = function (isNoCache) {this._nocache = isNoCache || false;};thi$.setRequestHeader = function (key, value) {this._headers = this._headers || {};this._headers[key] = value;};thi$.getTimeout = function () {return this._timeout;};thi$.setTimeout = function (v) {this._timeout = v;};thi$.isBlocking = function () {return this._blocking === true;};thi$.isOccupy = function () {return (this._occupy && true);};thi$.occupy = function () {this._usecount++;this._occupy = true;};thi$.contentType = function () {return this._xhr.contentType || this.getResponseHeader("Content-Type");};thi$.getResponseHeader = function (key) {return this._xhr.getResponseHeader(key);};thi$.getAllResponseHeaders = function () {return this._xhr.getAllResponseHeaders();};thi$.response = function () {var b;if (typeof self.Uint8Array == "undefined") {b = IEBinaryToString(this._xhr.responseBody).split(",");for (var i = 0, len = b.length; i < len; i++) {b[i] = parseInt(b[i]);}} else {b = new Uint8Array(this._xhr.response);}return b;};thi$.responseText = function () {return this._xhr.responseText;};thi$.responseXML = function () {return this._xhr.responseXML;};thi$.responseJSON = function () {var json, text = this.responseText();try {json = JSON.parse(text);}catch (x) {json = {err:-1, exception:x, text:text};}return json;};thi$.status = function () {return this._xhr.status;};thi$.statusText = function () {return this._xhr.statusText;};thi$.readyState = function () {return this._xhr.readyState;};thi$.open = function (method, url, params, withOutCookie) {J$VM.System.updateLastAccessTime();if (this.isBlocking()) {this.data = {method:method, url:url, params:params, withOutCookie:withOutCookie};J$VM.XHRPool.post(this);return;}var _url, query = _makeQueryString.call(this, params), xhr = this._xhr, bAsync = this.isAsync();switch (method.toUpperCase()) {case "GET":_url = (query != null) ? [url, "?", query].join("") : url;query = null;break;case "POST":_url = url;this.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");break;default:break;}if (bAsync) {xhr.onreadystatechange = function () {if (xhr.isTimeout || !self.J$VM) {return;}switch (xhr.readyState) {case 2:case 3:var status = 200;try {status = xhr.status;}catch (x) {}if (status != 200 && status != 304) {_stopTimeout.call(this);this.fireEvent(new Event(Event.SYS_EVT_HTTPERR, this, this));}break;case 4:_stopTimeout.call(this);switch (xhr.status) {case 200:case 304:this.fireEvent(new Event(Event.SYS_EVT_SUCCESS, this, this));break;default:this.fireEvent(new Event(Event.SYS_EVT_HTTPERR, this, this));break;}break;default:_stopTimeout.call(this);break;}}.$bind(this);}this.timer = _checkTimeout.$delay(this, this.getTimeout());xhr.open(method, _url, bAsync);_setRequestHeader.call(this, xhr, this._headers);if (bAsync) {(function () {xhr.send(query);}).$delay(this, 0);} else {xhr.send(query);}};thi$.close = function () {if (this._xhr) {_stopTimeout.call(this);var xhr = this._xhr;try {xhr.onreadystatechange = null;xhr.response = null;xhr.responseText = null;xhr.responseXML = null;}catch (x) {}}this["on" + Event.SYS_EVT_SUCCESS] = null;this["on" + Event.SYS_EVT_HTTPERR] = null;this["on" + Event.SYS_EVT_TIMEOUT] = null;this._headers = {};this._occupy = false;if (this._blocked === true) {this.xhr.close();delete this.xhr;delete this.data;delete this._blocked;}};var _checkTimeout = function () {var xhr = this._xhr;if (xhr) {xhr.isTimeout = true;xhr.abort();this.fireEvent(new Event(Event.SYS_EVT_TIMEOUT, this, this));}};var _stopTimeout = function () {_checkTimeout.$clearTimer(this.timer);delete this.timer;};var _makeQueryString = function (params) {if (params === null || params === undefined || typeof params != "object") {params = {};}var buf = [];for (var p in params) {buf.push(p, "=", params[p], "&");}if (this.isNoCache()) {buf.push("__=", J$VM.__version__);}return buf.join("");};var _setRequestHeader = function (_xhr, map) {if (map) {for (var p in map) {if (p === "responseType") {try {_xhr.responseType = map[p];}catch (e) {}} else {try {_xhr.setRequestHeader(p, map[p]);}catch (e) {}}}}};var _createXHR = function () {var xhr;if (self.XMLHttpRequest != undefined) {xhr = new XMLHttpRequest();} else {if (PV.progid != undefined) {xhr = new ActiveXObject(PV.progid);} else {for (var i = 0; i < PV.progids.length; i++) {PV.progid = PV.progids[i];try {xhr = new ActiveXObject(PV.progid);break;}catch (x) {}}}}return xhr;};thi$._init = function (isAsync, blocking) {this.setAsync(isAsync);if (blocking !== true) {this._xhr = _createXHR();} else {this._blocked = true;}this._blocking = blocking;this._usecount = 0;this.setTimeout(J$VM.System.getProperty("j$vm_ajax_timeout", 6000000));this.declareEvent(Event.SYS_EVT_TIMEOUT);}.$override(this._init);this._init(isAsync, blocking);}.$extend(js.util.EventTarget);

$package("js.awt");$import("js.util.Event");js.awt.Event = function (e) {var CLASS = js.awt.Event, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;var DOM = J$VM.DOM, Event = js.util.Event;thi$.eventXY = function () {return {x:this.clientX, y:this.clientY};};thi$.offsetXY = function () {return {x:this.offsetX, y:this.offsetY};};thi$.cancelBubble = function () {var _e = this._event;if (!(_e instanceof js.util.Event)) {if (_e.stopPropagation) {_e.stopPropagation();} else {try {_e.cancelBubble = true;}catch (x) {}}}$super(this);}.$override(this.cancelBubble);thi$.cancelDefault = function () {var _e = this._event;if (!(_e instanceof js.util.Event)) {if (_e.preventDefault) {_e.preventDefault();} else {try {_e.returnValue = false;}catch (x) {}}}return $super(this);}.$override(this.cancelDefault);var isOver = function (type) {return Event.W3C_EVT_MOUSE_OVER === type;};var isOut = function (type) {return Event.W3C_EVT_MOUSE_OUT === type;};var keys = ["altKey", "ctrlKey", "shiftKey", "metaKey", "keyCode", "button", "pointerId", "pointerType", "clientX", "clientY", "offsetX", "offsetY", "srcElement", "fromElement", "toElement", "_type", "_data", "_target"], keyslen = keys.length;thi$.clone = function (type, data, target) {var evt = new (CLASS)(this), i, key;for (i = 0; i < keyslen; i++) {key = keys[i];evt[key] = this[key];}if (type) {evt.setType(type);}if (data) {evt.setData(data);}if (target) {evt.setEventTarget(target);}return evt;};var btns = [1, 4, 2, 8, 16];thi$._init = function (e) {var _e = this._event = e || window.event;if (e instanceof js.awt.Event) {$super(this, _e.type, e._event);return;}$super(this, _e.type, _e);var ie = (_e.stopPropagation == undefined), ff = (J$VM.firefox != undefined), domE = document.documentElement, body = document.body;this.altKey = _e.altKey || false;this.ctrlKey = _e.ctrlKey || false;this.shiftKey = _e.shiftKey || false;this.metaKey = _e.metaKey || false;this.keyCode = ie ? _e.keyCode : _e.which;this.button = _e.buttons ? _e.buttons : (!J$VM.ie && _e.button >= 0) ? btns[_e.button] : _e.button;this.pointerId = _e.pointerId || 0;this.pointerType = _e.pointerType || (_e.type.startsWith("touch") ? "touch" : "mouse");this.clientX = !isNaN(_e.pageX) ? _e.pageX : (_e.clientX + domE.scrollLeft - body.clientLeft);this.clientY = !isNaN(_e.pageY) ? _e.pageY : (_e.clientY + domE.scrollTop - body.clientTop);this.offsetX = ff ? _e.layerX : _e.offsetX;this.offsetY = ff ? _e.layerY : _e.offsetY;this.srcElement = ie ? _e.srcElement : _e.target;this.fromElement = ie ? _e.fromElement : (isOver(_e.type) ? _e.relatedTarget : (isOut(_e.type) ? _e.target : undefined));this.toElement = ie ? _e.toElement : (isOut(_e.type) ? _e.relatedTarget : (isOver(_e.type) ? _e.target : undefined));this.setEventTarget(DOM.getComponent(this.srcElement));}.$override(this._init);this._init.apply(this, arguments);}.$extend(js.util.Event);

$package("js.awt");js.awt.ComponentFactory = function (System) {var CLASS = js.awt.ComponentFactory, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init();return;}CLASS.__defined__ = true;var Class = js.lang.Class;thi$.registerClass = function (wClass) {var className = wClass.className;if (this._classes[className] == undefined) {this._classes[className] = wClass;} else {throw new Error("The class definition " + className + " is existed.");}return className;};thi$.unRegisterClass = function (className) {delete this._classes[className];};thi$.getClass = function (className, nocache) {var _wClass = this._classes[className], wClass;if (_wClass == undefined) {throw "Can not found the wClass with name " + className;}return nocache === true ? _wClass : System.objectCopy(_wClass, {}, true);};thi$.hasClass = function (className) {return Class.isObject(this._classes[className]);};thi$.createComponent = function (className, opitons, Runtime) {var comp, wClass = this.getClass(className);wClass = System.objectCopy(opitons || {}, wClass, true, true);comp = new (Class.forName(wClass.classType))(wClass, Runtime);return comp;};thi$._init = function () {this._classes = {};};this._init();};

js.lang.Service = function (def, Runtime) {var CLASS = js.lang.Service, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;var Class = js.lang.Class, Event = js.util.Event;thi$.destroy = function () {$super(this);}.$override(this.destroy);thi$._init = function (def, Runtime) {if (def === undefined) {return;}this.uuid("service");def.__contextid__ = "runtime";$super(this);}.$override(this._init);this._init.apply(this, arguments);}.$extend(js.util.EventTarget);

js.lang.Runtime = function (System) {var CLASS = js.lang.Runtime, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;var Class = js.lang.Class, Event = js.util.Event;thi$.registerService = function (service) {this._service = service;};thi$.getService = function () {var service = this._service;if (!service) {service = this._service = new js.lang.Service({}, this);}return service;};thi$.registerDesktop = function (desktop) {this._desktop = desktop;};thi$.getDesktop = function () {return this._desktop;};var procs = [];thi$.exec = function (entryId, fn) {procs.push({entry:entryId, fn:fn});};var scopes = J$VM.runtime = {};thi$._execProcs = function () {var proc, scope, entry;while (procs.length > 0) {proc = procs.shift();entry = proc.entry;if (entry) {scope = scopes[entry] = (scopes[entry] || _newScope.call(this, entry));} else {scope = this;}(function (scope, proc) {proc.fn.call(scope, proc.entry);}).$delay(this, 0, scope, proc);}};var _newScope = function (entryId) {var runtimeScope = function () {this.getEntryID = function () {return entryId;};this.createApp = function (def) {var app = new appPromise(this);_createApp.$delay(this, 0, entryId, def, app);return app;};this.getApp = function () {return this.Application;};var _createApp = function (entryId, def, promise) {def = def || {zorder:true};def.classType = def.classType || "js.awt.Application";var appClass = Class.forName(def.classType), app;app = new (appClass)(def, this, entryId);promise.done(app);};var appPromise = function (runtime) {var tasks = [];this.startApp = function () {this.run();};this.run = function (fn) {if (Class.isFunction(fn)) {tasks.push(fn);}return this;};this.done = function (app) {runtime.Application = app;runtime.getDesktop().registerApp(runtime.getEntryID(), app);app.startApp();while (tasks.length > 0) {tasks.shift().call(app);}};};};runtimeScope.prototype = this;runtimeScope = js.lang.Object.$decorate(new runtimeScope());runtimeScope.uuid(this.uuid() + "_" + entryId);runtimeScope.setContextID(this.uuid());runtimeScope.putContextAttr("runtime", runtimeScope);return runtimeScope;};thi$.isEmbedded = function () {return self != self.parent;};thi$.isSamePID = function () {if (this.isEmbedded()) {var pJ$VM;try {pJ$VM = self.parent.J$VM;return pJ$VM && (pJ$VM.Runtime.PID() == this.PID());}catch (x) {}}return false;};thi$.getProperty = function (key, defValue) {return System.getProperty(key, defValue);};thi$.setProperty = function (key, value) {System.setProperty(key, value);};thi$.prefer = function (prefer) {if (Class.isObject(prefer)) {this.setProperty("prefer", prefer);}return this.getProperty("prefer", {});};thi$.themes = function (themes) {if (Class.isArray(themes)) {this.setProperty("themes", themes);}return this.getProperty("themes", ["default"]);};thi$.theme = function (theme) {if (Class.isString(theme)) {this.setProperty("theme", theme);}return this.getProperty("theme", "default");};var _isAbsPath = function (url) {return url.indexOf("http") === 0;};thi$.imagePath = function (imagePath) {if (Class.isString(imagePath)) {if (!_isAbsPath(imagePath)) {imagePath = J$VM.DOM.makeUrlPath(J$VM.env.j$vm_home, imagePath);}this.setProperty("imagePath", imagePath);}return this.getProperty("imagePath", J$VM.DOM.makeUrlPath(J$VM.env.j$vm_home, "../style/" + this.theme() + "/images/"));};thi$.PID = function (pid) {if (Class.isString(pid)) {this.setProperty("j$vm_pid", pid);}return this.getProperty("j$vm_pid", "");};thi$.postEntry = function (entry) {if (Class.isString(entry)) {if (!_isAbsPath(entry)) {entry = J$VM.DOM.makeUrlPath(J$VM.env.j$vm_home, entry);}this.setProperty("postEntry", entry);}return this.getProperty("postEntry", J$VM.DOM.makeUrlPath(J$VM.env.j$vm_home, this.PID() + ".vt"));};thi$.getsEntry = function (entry) {if (Class.isString(entry)) {if (!_isAbsPath(entry)) {var home = J$VM.env.j$vm_home, p = home.indexOf(J$VM.env.j$vm_webroot);home = home.substring(0, p + 1);entry = J$VM.DOM.makeUrlPath(home, entry);}this.setProperty("getsEntry", entry);}return this.getProperty("getsEntry", J$VM.DOM.makeUrlPath(J$VM.env.j$vm_home, "../../vt"));};thi$.nlsText = function (text, defVal) {return defVal;};thi$.message = function (type, subject, content, title, rect, handler) {var msgbox = {className:"msgbox", model:{msgType:type, title:title || "", msgSubject:subject || "", msgContent:content || " "}};this.getDesktop().openDialog("message", rect || {}, new js.awt.MessageBox(msgbox, this), handler);};thi$.initialize = function (env) {System.getProperties().addAll(env || {});if (env.postEntry) {this.postEntry(env.postEntry);}if (env.getsEntry) {this.getsEntry(env.getsEntry);}if (env.imagePath) {this.imagePath(env.imagePath);}};thi$.destroy = function () {if (this._service) {this._service.destroy();this._service = null;}if (this._desktop) {this._desktop.destroy();this._desktop = null;}procs = null;scopes = null;$super(this);}.$override(this.destroy);thi$._init = function (system) {System = system;arguments.callee.__super__.call(this, {uuid:"runtime"}, this);}.$override(this._init);this._init.apply(this, arguments);}.$extend(js.util.EventTarget);

js.lang.System = function (env, vm) {var props, os, lastAccessTime;this.currentTimeMillis = function () {return (new Date()).getTime();};this.hasProperty = function (key) {return props.contains(key);};this.getProperties = function () {return props;};this.getProperty = function (key, defaultValue) {return props.getProperty(key, defaultValue);};this.setProperty = function (key, value) {props.setProperty(key, value);return this.getProperty(key);};this.removeProperty = function (key) {return props.remove(key);};this.setOut = function (print) {os = print;};this.out = function () {return {println:function (s) {if (os) {os.info(s);}}};}();this.err = function () {return {println:function (s) {if (os) {os.error(s);}}};}();this.log = function () {return {println:function (s) {var $ = props.getProperty("j$vm_log", false);if (os && $ === true) {os.log(s);}}};}();this.exit = function () {this.gc();window.open("", "_self");window.close();};var _last = 0;this.updateLastAccessTime = function () {var now = this.currentTimeMillis();if (self.parent !== self && now - _last > 1000) {_last = now;J$VM.MQ.post("j$vm_activating", null, [], self.parent);}lastAccessTime = this.currentTimeMillis();};this.getLastAccessTime = function () {return lastAccessTime;};this.getMaxInactiveInterval = function () {return this.getProperty("j$vm_max_inactive", 1800000);};this.setMaxInactiveInterval = function (interval) {this.setProperty("j$vm_max_inactive", interval);};this.objectCopy = function (src, des, deep, merge) {var Class = js.lang.Class, item;switch (Class.typeOf(src)) {case "object":des = (des === null || des === undefined) ? {} : des;for (var p in src) {item = src[p];if (deep === true) {if (src._transient && src._transient[p]) {continue;}switch (Class.typeOf(item)) {case "object":if (merge === true) {des[p] = this.objectCopy(item, des[p], deep, merge);} else {des[p] = this.objectCopy(item, null, deep);}break;case "array":des[p] = this.arrayCopy(item, 0, [], 0, item.length, deep);break;default:des[p] = item;}} else {des[p] = item;}}break;case "array":des = this.arrayCopy(src, 0, des, 0, src.length, deep);break;default:des = src;break;}return des;};this.arrayCopy = function (src, srcPos, des, desPos, length, deep) {var Class = js.lang.Class, srcIdx = srcPos, desIdx = desPos, item;des = (des === null || des === undefined) ? [] : des;for (var i = 0; i < length; i++) {if (srcIdx > src.length - 1) {break;}item = src[srcIdx];if (deep === true) {switch (Class.typeOf(item)) {case "object":des[desIdx++] = this.objectCopy(item, null, deep);break;case "array":des[desIdx++] = this.arrayCopy(item, 0, [], 0, item.length, deep);break;default:des[desIdx++] = item;break;}} else {des[desIdx++] = item;}srcIdx++;}return des;};var _buildEnv = function () {var script = document.getElementById("j$vm");if (script) {var attrs = script.attributes, uri, name, value, params, p;for (var i = 0, len = attrs.length; i < len; i++) {name = attrs[i].nodeName;value = attrs[i].value;switch (name) {case "src":case "crs":value = script.src || script.getAttribute("crs");uri = new js.net.URI(value);this.setProperty("j$vm_uri", uri);params = uri.params;for (p in params) {this.setProperty(p, params[p]);}value = script.getAttribute("crs") || script.src;if (value.indexOf("http") !== 0) {var srcpath = script.src;p = srcpath.lastIndexOf("/");srcpath = srcpath.substring(0, p + 1);value = srcpath + value;}p = value.lastIndexOf("/");uri = document.createElement("A");uri.href = value.substring(0, p + 1);this.setProperty("j$vm_home", uri.href);vm.j$vm_home = uri.href;break;case "classpath":value = value.replace(/(\s*)/g, "");this.setProperty("j$vm_classpath", value);break;default:if (name.indexOf("-d") == 0 || name.indexOf("-D") == 0) {var tmp = parseInt(value);value = isNaN(tmp) ? (value === "true" ? true : (value === "false" ? false : value)) : tmp;this.setProperty(name.substring(2).toLowerCase(), value);}break;}}vm.uuid("j$vm_" + js.lang.Math.uuid());vm.id = vm.uuid();} else {throw new Error("Can't not found J$VM home");}};var _buildWorkerEnv = function () {var path = self.j$vm_home, p;if (path.startsWith("../")) {path = vm.env.uri.source;p = path.indexOf("classes/js/util/Worker.jz");path = path.substring(0, p);}vm.env.j$vm_home = vm.j$vm_home = path;vm.uuid("j$vm_" + js.lang.Math.uuid());vm.id = vm.uuid();};var _onload = function (e) {J$VM.System.out.println([J$VM.__product__, J$VM.__version__, "loading..."].join(" "));var b = vm.storage.session.getItem("j$vm_log");if (b === "true") {vm.enableLogger();} else {vm.disableLogger();}J$VM.DOM.checkDoctype();J$VM.DOM.checkBrowser();vm.locale = new js.util.Locale();var Runtime = vm.Runtime;if (js.awt.Desktop) {Runtime.registerDesktop(new js.awt.Desktop(vm.Runtime));}Runtime._execProcs();};var _onbeforeunload = function () {};var _onunload = function (e) {J$VM.System.out.println("J$VM unload...");J$VM.Runtime.destroy();var names = ["$import", "$package", "$load_package", "$postMessage", "$sendMessage", "J$VM", "js", "com", "org"], name;for (var i = 0, len = names.length; i < len; i++) {name = names[i];self[name] = null;try {delete self[name];}catch (x) {}}try {self.document.innerHTML = "";}catch (e) {}};var _enableLogger = function () {this.setProperty("j$vm_log", true);J$VM.storage.session.setItem("j$vm_log", "true");return "J$VM logger is enabled";}.$bind(this);var _disableLogger = function () {this.setProperty("j$vm_log", false);J$VM.storage.session.setItem("j$vm_log", "false");return "J$VM logger is disabled";}.$bind(this);this.isLogEnabled = function () {return this.getProperty("j$vm_log") == true;};var _init = function (env, vm) {var Event = js.util.Event;props = new js.util.Properties(env);vm.Class = js.lang.Class;vm.MQ = new js.util.Messenger(this);vm.Runtime = new js.lang.Runtime(this);if (!vm.env.j$vm_isworker) {vm.pkgversion = self.j$vm_pkgversion || {};try {delete self.j$vm_pkgversion;}catch (e) {}vm.__version__ += vm.pkgversion["package.jz"] || Math.uuid();_buildEnv.call(this);os = self.console ? self.console : null;vm.hwnd = self;vm.DOM = new js.util.Document();vm.Factory = new js.awt.ComponentFactory(this);vm.storage = {local:js.util.Storage.getStorage("local"), session:js.util.Storage.getStorage("session"), memory:js.util.Storage.getStorage("memory"), cookie:new js.util.CookieStorage()};vm.storage.cache = new js.util.Cache();vm.storage.images = new js.util.MemoryStorage(this.getProperty("j$vm_images_cachesize", 256));vm.enableLogger = _enableLogger;vm.disableLogger = _disableLogger;vm.exec = vm.Runtime.exec;Event.attachEvent(self, Event.W3C_EVT_LOAD, 0, this, _onload);Event.attachEvent(self, Event.W3C_EVT_UNLOAD, 0, this, _onunload);} else {os = new function () {var post = vm.MQ.post;this.info = function (s) {post(Event.SYS_MSG_CONSOLEINF, s, [], self, 1);};this.error = function (s) {post(Event.SYS_MSG_CONSOLEERR, s, [], self, 1);};this.log = function (s) {post(Event.SYS_MSG_CONSOLELOG, s, [], self, 1);};}();_buildWorkerEnv.call(this);}};if (env != undefined && vm != undefined) {_init.apply(this, arguments);}}.$extend(js.lang.Object);

js.lang.Thread = function (Runnable) {var CLASS = js.lang.Thread, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;var Class = js.lang.Class, Event = js.util.Event, System = J$VM.System, MQ = J$VM.MQ;var _onmessage = function (e) {var evt = e.getData(), data;if (evt.source == self) {return;}try {data = JSON.parse(evt.data);}catch (x) {data = evt.data;}if (Class.isArray(data)) {switch (data[0]) {case Event.SYS_MSG_CONSOLEINF:System.out.println(data[1]);break;case Event.SYS_MSG_CONSOLEERR:System.err.println(data[1]);break;case Event.SYS_MSG_CONSOLELOG:System.log.println(data[1]);break;default:var fun = "on" + data[0];if (typeof this[fun] == "function") {this[fun](data[1]);}}} else {if (typeof this.onmessage == "function") {this.onmessage(data);}}};var _onerror = function (e) {var evt = e.getData(), data;if (evt.source == self) {return;}System.err.println(evt.data);};thi$.submitTask = function (task, isRunnable) {if (task == undefined || task == null) {return;}isRunnable = isRunnable || false;var context, run, worker = this._worker;if (isRunnable) {context = task.context;run = task.run;} else {context = task;run = this._runnable.run;}var buf = new js.lang.StringBuffer();buf.append("var thi$ = {");buf.append("context:").append(JSON.stringify(context));buf.append(",run:").append(run);buf.append("}");var msg = buf.toString();if (this._realWorker === true) {worker.postMessage(msg);} else {worker.postMessage(msg, "*");}};thi$.start = function () {this.submitTask(this._runnable, true);};thi$.stop = function () {if (this._worker.terminate) {this._worker.terminate();} else {}};thi$._init = function (Runnable) {this._runnable = Runnable || {context:{}, run:function () {J$VM.System.out.println("Web Worker is running");}};var path = J$VM.j$vm_home + "classes/js/util/", worker_url = path + "Worker.jz?__=" + J$VM.__version__;if (self.Worker) {try {this._worker = new Worker(worker_url);this._realWorker = true;}catch (ex) {var code = Class.getResource(worker_url), codeBlob, codeUrl;code = code.replace("../../../", J$VM.j$vm_home);codeBlob = new Blob([code], {type:"text/javascript"});codeUrl = self.URL.createObjectURL(codeBlob);this._worker = new Worker(codeUrl);self.URL.revokeObjectURL(codeUrl);this._realWorker = true;}} else {var iframe = document.createElement("iframe");iframe.style.cssText = "visibility:hidden;border:0;width:0;height:0;";document.body.appendChild(iframe);var text = new js.lang.StringBuffer();text = text.append("<!DOCTYPE html>\n<html><head>").append("<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>").append("</head></html>").toString();var doc = iframe.contentWindow.document, head, script;doc.open();doc.write(text);doc.close();head = doc.getElementsByTagName("head")[0];text = Class.getResource(J$VM.j$vm_home + "jsre.js", true);script = doc.createElement("script");script.type = "text/javascript";script.id = "j$vm";script.setAttribute("crs", J$VM.j$vm_home);script.setAttribute("classpath", "");script.text = text;text = Class.getResource(path + "Worker.jz", true);script.text += text;head.appendChild(script);head.removeChild(script);this._worker = iframe.contentWindow;this._realWorker = false;}Event.attachEvent(this._worker, Event.W3C_EVT_MESSAGE, 0, this, _onmessage);Event.attachEvent(this._worker, Event.W3C_EVT_ERROR, 0, this, _onerror);};this._init.apply(this, arguments);}.$extend(js.lang.Object);

$package("js.sql");js.sql.Types = new function () {this.BIT = -7;this.TINYINT = -6;this.SMALLINT = 5;this.INTEGER = 4;this.BIGINT = -5;this.FLOAT = 6;this.REAL = 7;this.DOUBLE = 8;this.NUMERIC = 2;this.DECIMAL = 3;this.CHAR = 1;this.VARCHAR = 12;this.LONGVARCHAR = -1;this.DATE = 91;this.TIME = 92;this.TIMESTAMP = 93;this.BINARY = -2;this.VARBINARY = -3;this.LONGVARBINARY = -4;this.NULL = 0;this.OTHER = 1111;this.JAVA_OBJECT = 2000;this.DISTINCT = 2001;this.STRUCT = 2002;this.ARRAY = 2003;this.BLOB = 2004;this.CLOB = 2005;this.REF = 2006;this.DATALINK = 70;this.BOOLEAN = 16;this.ROWID = -8;this.NCHAR = -15;this.NVARCHAR = -9;this.LONGNVARCHAR = -16;this.NCLOB = 2011;this.SQLXML = 2009;var _sqlMapName = {}, _nameMapsql = {};this.getNameBySql = function (sql) {return _sqlMapName["" + sql];};this.getSqlByName = function (name) {name = name || "";return _nameMapsql[name.toUpperCase()];};(function () {var Class = js.lang.Class, p, v;for (p in this) {v = this[p];if (Class.isNumber(v)) {_sqlMapName["" + v] = p;_nameMapsql[p] = v;}}}).call(this);}();

$package("js.math");js.math.Traveller = new (function () {this.trave = function (handler, node, level) {var nodes;level = level || 0;handler.apply(node, level);if (handler.isLeaf()) {return;}nodes = handler.getMembers();for (var i = 0, len = nodes.length; i < len; i++) {this.trave(handler, nodes[i], level + 1);}};})();js.math.TraveHandler = function (data) {var CLASS = js.math.TraveHandler, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;var Class = js.lang.Class, System = J$VM.System;thi$.apply = function (node, level) {this.node = node;var U = this._local, levels = U.levels, lnodes = levels[level], path, i;if (!lnodes) {lnodes = levels[level] = [];}lnodes.push(node);if (this.isLeaf()) {path = [];for (i = 0; i <= level; i++) {lnodes = levels[i];path.push(lnodes[lnodes.length - 1]);}U.paths.push(path);}};thi$.getPath = function (index) {return this._local.paths[index];};thi$.getDeepth = function () {var U = this._local, levels = U.levels;return levels.length;};thi$.getBreadth = function () {var U = this._local, paths = U.paths;return paths.length;};thi$.isLeaf = function () {var nodes = this.getMembers();return !Class.isArray(nodes);};thi$.getMembers = function () {return this.node.nodes;};thi$._init = function (data) {if (data === undefined) {return;}this._local = {};var U = this._local;U.levels = [];U.paths = [];};this._init.apply(this, arguments);};

$package("js.text");js.text.BigIntTools = function () {var CLASS = js.text.BigIntTools, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;var Class = js.lang.Class, System = J$VM.System;thi$.parse = function (str) {return this.parseBigInt(str);};thi$.format = function (obj) {if (!Class.isBigInt(obj)) {return NaN;}var str = this.patternM.prefix.join("");str = str + _toString.call(this, obj);str = str + this.patternM.suffix.join(str);return str;};thi$.setPattern = function (pattern) {if (pattern.replace(this.reg.all, "") !== "") {throw "The pattern is illegal !";}_initPatternM.call(this);var prePart = pattern.match(this.reg.prefix);var sufPart = pattern.match(this.reg.suffix);var middle = pattern.replace(this.reg.prefix, "");var fix = pattern.split(middle);middle = middle.replace(/,(?=.*,\.?[#|0])/g, "");middle = middle.replace(/,(?!\.?[#|0])/g, "");_preparePatternM.call(this, fix, middle);};var _preparePatternM = function (fix, middle) {var allFix = fix.join("");var prefix = fix[0].replace("%", "");var suffix = fix[fix.length - 1].replace("%", "");if (allFix.indexOf("%") != -1) {this.patternM.percent = true;}var c = middle.indexOf(","), d = middle.indexOf("."), cLen = middle.replace(".", "").length, dLen = middle.replace(/.*\./, "").replace(/[^0]/g, "").length;if (c !== -1 && d !== -1) {if (c < d) {this.patternM.commaInterval = d - c - 1;this.patternM.decimal = dLen;} else {this.patternM.decimal = dLen;}} else {if (c !== -1 && d === -1) {this.patternM.commaInterval = cLen - c - 1;} else {if (c === -1 && d !== -1) {this.patternM.decimal = dLen;}}}this.patternM.prefix.push(prefix);this.patternM.suffix.push(suffix);};var _toString = function (obj) {var str = "", array, negative = obj.negative, c = this.patternM.commaInterval, d = this.patternM.decimal;array = this.patternM.percent ? [0, 0].concat(obj.array) : obj.array;for (var i = array.length - 1; i > -1; i--) {if ((i + 1) % c === 0 && i !== array.length - 1 && i !== 0) {str += ",";}str += array[i];}if (d > -1) {str += ".";for (var j = 0; j < d; j++) {str += "0";}}if (this.patternM.percent) {str += "%";}return str === "0" ? str : negative ? "-" + str : str;};thi$.parseBigInt = function (obj) {if (Class.isBigInt(obj)) {return obj;} else {if (Class.isString(obj)) {obj.trim();}}return new js.text.BigInt(obj);};thi$.calculate = function (expression) {if (Class.typeOf(expression) === "array") {return _calculate.call(this, expression);}if (Class.typeOf(expression) !== "string") {return NaN;}var result = expression.replace(/\s/g, ""), _expression;if (Class.typeOf(arguments[1]) === "object") {var params = arguments[1];for (var paramName in params) {result = result.replace(new RegExp(paramName, "g"), params[paramName]);}} else {if (arguments[1] !== undefined) {var _caller = arguments.callee.caller;if (this.calMap[_caller] === undefined) {var callerStr = _caller.toString().replace(/\/\*(\*(?!\/)|[^\*])*\*\//g, "");callerStr = callerStr.replace(/\/\/.*/g, "");callerStr = _findTopLevelNested.call(this, callerStr, "{", "}")[0].slice(1, -2);var func = _findFunction.call(this, callerStr);for (var i in func) {callerStr = callerStr.replace(func[i], "");}callerStr = callerStr.replace(/\s/g, "").match(/\.calculate\("[^"]*"(,\w+)+/g);this.calMap[_caller] = callerStr;}var calExp = this.calMap[_caller], temp, varList;for (var k = 0; k < calExp.length; k++) {temp = calExp[k].replace(/\.calculate\(|\s/g, "").split(",");if (temp.shift().replace(/"/g, "") === result) {varList = [null].concat(temp);calExp.splice(k, 1);break;}}if (arguments.length > 1) {for (var i = 1, len = arguments.length; i < len; i++) {result = result.replace(new RegExp(varList[i], "g"), arguments[i]);}}if (this.calMap[_caller].length === 0) {this.calMap[_caller] = undefined;delete this.calMap[_caller];}}}result = _transToPolish.call(this, result);return _calculate.call(this, result);};var _calculate = function (expression) {if (Class.typeOf(expression) === "string") {return this.parseBigInt(expression);}if (expression.length < 3) {throw "The expression is not right!";}var e0 = expression[0], e1 = expression[1];var ret = Class.typeOf(e1) === "array" ? _calculate.call(this, e1) : e1;switch (e0) {case "+":for (var i = 2, len = expression.length; i < len; i++) {if (Class.typeOf(expression[i]) === "array") {ret = this.plus(ret, _calculate.call(this, expression[i]));} else {ret = this.plus(ret, expression[i]);}}break;case "-":for (i = 2, len = expression.length; i < len; i++) {if (Class.typeOf(expression[i]) === "array") {ret = this.minus(ret, _calculate.call(this, expression[i]));} else {ret = this.minus(ret, expression[i]);}}break;case "*":for (i = 2, len = expression.length; i < len; i++) {if (Class.typeOf(expression[i]) === "array") {ret = this.multiply(ret, _calculate.call(this, expression[i]));} else {ret = this.multiply(ret, expression[i]);}}break;case "/":for (i = 2, len = expression.length; i < len; i++) {if (Class.typeOf(expression[i]) === "array") {ret = this.divid(ret, _calculate.call(this, expression[i]));} else {ret = this.divid(ret, expression[i]);}}break;default:break;}return ret;};var _transToPolish = function (expression) {var s1 = [], s2 = [], temp, ret, _char, _number = "", k;for (var i = expression.length - 1; i > -1; i--) {_char = expression.charAt(i);if (isNaN(+_char) && !_isNegative.call(this, _char, i, expression) && _char !== ".") {if (_number !== "") {s1.unshift(_number);_number = "";}switch (_char) {case "(":k = 0;while (true && k < 100) {if (s2[0] === ")") {s2.shift();break;} else {s1.unshift([s2.shift(), s1.shift(), s1.shift()]);}k++;}break;case ")":s2.unshift(_char);break;case "*":case "/":s2.unshift(_char);break;case "+":case "-":k = 0;while (true && k < 100) {if (s2[0] === "*" || s2[0] === "/") {s1.unshift([s2.shift(), s1.shift(), s1.shift()]);} else {s2.unshift(_char);break;}k++;}break;}} else {_number = _char + _number;if (i === 0) {s1.unshift(_number);}}}i = 0;while (s2.length !== 0 && i < 100) {if (!ret) {ret = [s2.shift(), s1.shift(), s1.shift()];} else {ret = [s2.shift(), ret, s1.shift()];}i++;}if (s1.length === 1) {return s1.shift();}return ret;};var _isNegative = function (_char, index, expression) {if (_char !== "-") {return false;}if (index === 0) {return true;}var preChar = expression.charAt(index - 1);if (preChar === "+" || preChar === "-" || preChar === "*" || preChar === "/") {return true;}return false;};var _findFunction = function (str) {var ret = [], s = "\\{", e = "\\}";var func = "function.*\\(.*\\)";var pattern = s + "[^" + s + e + "]*" + e, flag = true, temp = [], i = 0;while (flag) {temp = str.match(new RegExp(func + pattern + ";?", "g"));if (temp && temp.join("") !== ret.join("")) {ret = temp;pattern = s + "([^" + s + e + "]|" + pattern + ")*" + e;} else {flag = false;}}return ret;};var _findTopLevelNested = function (str, startSymbol, endSymbol) {var ret = [], reg = new RegExp(), s = _checkPattern(startSymbol), e = _checkPattern(endSymbol);var pattern = s + "[^" + s + e + "]*" + e, flag = true, temp = [], i = 0;while (flag) {reg.compile(pattern, "g");temp = str.match(reg);if (temp && temp.join("") !== ret.join("")) {ret = temp;pattern = s + "([^" + s + e + "]|" + pattern + ")*" + e;} else {flag = false;}}return ret;};var _checkPattern = function (pattern) {pattern = pattern.replace(/\\/g, "\\\\");pattern = pattern.replace(/\//g, "\\/");pattern = pattern.replace(/\./g, "\\.");pattern = pattern.replace(/\*/g, "\\*");pattern = pattern.replace(/\+/g, "\\+");pattern = pattern.replace(/\?/g, "\\?");pattern = pattern.replace(/\$/g, "\\$");pattern = pattern.replace(/\[/g, "\\[");pattern = pattern.replace(/\]/g, "\\]");pattern = pattern.replace(/\(/g, "\\(");pattern = pattern.replace(/\)/g, "\\)");pattern = pattern.replace(/\{/g, "\\{");pattern = pattern.replace(/\}/g, "\\}");pattern = pattern.replace(/\^/g, "\\^");pattern = pattern.replace(/\|/g, "\\|");return pattern;};thi$.test = function () {var ret, tools = this, v0 = 11111111, v1 = 2, time = 3;var s = new Date(), e;for (var i = 0; i < 1000; i++) {ret = tools.calculate("(v0*time + v1)*((v0-v1)/time - v0)", v0, v1, time);}e = new Date();System.out.println(ret + "");System.out.println(e - s);s = new Date();for (i = 0; i < 1000; i++) {ret = tools.calculate("(v0*time + v1)*( (v0-v1)/time - v0)", {v0:v0, v1:v1, time:time});}e = new Date();System.out.println(ret + "");System.out.println(e - s);s = new Date();for (i = 0; i < 1000; i++) {ret = tools.calculate(["*", ["+", ["*", v0, time], v1], ["-", ["/", ["-", v0, v1], time], v0]]);}e = new Date();System.out.println(ret + "");System.out.println(e - s);s = new Date();v0 = tools.parseBigInt(v0);for (i = 0; i < 1000; i++) {ret = v0.multiply(time).plus(v1).multiply(v0.minus(v1).divid(time).minus(v0));}e = new Date();System.out.println(ret + "");System.out.println(e - s);};thi$.plus = function (a, b) {var x = this.parseBigInt(a), y = this.parseBigInt(b);return x.plus(y);};thi$.minus = function (a, b) {var x = this.parseBigInt(a), y = this.parseBigInt(b);return x.minus(y);};thi$.multiply = function (a, b) {var x = this.parseBigInt(a), y = this.parseBigInt(b);return x.multiply(b);};thi$.divid = function (a, b) {var x = this.parseBigInt(a), y = this.parseBigInt(b);return x.divid(y);};thi$.divisible = function (a, b) {var x = this.parseBigInt(a), y = this.parseBigInt(b);return x.divisible(y);};thi$.mod = function (a, b) {var x = this.parseBigInt(a), y = this.parseBigInt(b);return x.mod(y);};thi$.round = function (obj) {var o = this.parseBigInt(obj + "");return o.round();};thi$.floor = function (obj) {var o = this.parseBigInt(obj + "");return o.floor();};thi$.ceil = function (obj) {var o = this.parseBigInt(obj + "");return o.ceil();};thi$.sort = function (array, desc) {var temp;for (var i = 0, j = array.length; i < j; i++) {if (i === j - 1) {i = -1;j--;continue;}if (this.moreThan(array[i], array[i + 1]) && !desc) {temp = array[i];array[i] = array[i + 1];array[i + 1] = temp;} else {if (this.lessThan(array[i], array[i + 1]) && desc) {temp = array[i];array[i] = array[i + 1];array[i + 1] = temp;}}}return array;};thi$.a_LessThan_b = function () {System.err.println("This method is not deprecated!");this.lessThan();};thi$.a_MoreThan_b = function () {System.err.println("This method is deprecated!");this.moreThan();};thi$.a_Equals_b = function () {System.err.println("This method is deprecated!");this.equals();};thi$.a_LessOrEqual_b = function () {System.err.println("This method is deprecated!");this.lessOrEqual();};thi$.a_MoreOrEqual_b = function () {System.err.println("This method is deprecated!");this.moreOrEqual();};thi$.lessThan = function (a, b) {var x = this.parseBigInt(a), y = this.parseBigInt(b);return x.lessThan(b);};thi$.moreThan = function (a, b) {var x = this.parseBigInt(a), y = this.parseBigInt(b);return x.moreThan(b);};thi$.equals = function (a, b) {var x = this.parseBigInt(a), y = this.parseBigInt(b);return x.equal(b);};thi$.lessOrEqual = function (a, b) {var x = this.parseBigInt(a), y = this.parseBigInt(b);return x.lessOrEqual(b);};thi$.moreOrEqual = function (a, b) {var x = this.parseBigInt(a), y = this.parseBigInt(b);return x.moreOrEqual(b);};var _initPatternM = function () {this.patternM = {prefix:[], commaInterval:0, decimal:-1, percent:false, suffix:[]};};thi$._init = function (pattern) {this.reg = {prefix:/[^(#|0|,|\.)]*/g, suffix:/[^(#|0|,|\.)]*/g, middle:/[#|0|,]*\.?[#|0|,]*/, all:/[^(#|0|,|\.)]*[#|0|,]*\.?[#|0|,]*[^(#|0|,|\.)]*/};this.calMap = {};_initPatternM.call(this);this.setPattern(pattern || "####");};this._init.apply(this, arguments);};js.text.BigInt = function (data) {var CLASS = js.text.BigInt, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;var Class = js.lang.Class, System = J$VM.System;thi$.toString = function () {return this.valueOf();}.$override(this.toString);thi$.valueOf = function () {var str = "", array = this.array, negative = this.negative, decArray = this.decArray;for (var i = array.length - 1; i > -1; i--) {str += array[i];}if (decArray.length !== 0) {str += ".";for (var j = decArray.length - 1; j > -1; j--) {str += decArray[j];}}return str === "0" ? str : negative ? "-" + str : str;}.$override(this.valueOf);thi$.parseBigInt = function (data) {if (data === undefined) {return new js.text.BigInt();} else {if (Class.isBigInt(data)) {var _new = new js.text.BigInt();_new.array = data.array.slice();_new.decArray = data.decArray.slice();_new.negative = data.negative;return _new;}}return new js.text.BigInt(data);};thi$.plus = function (b) {var x = this.parseBigInt(this), y = this.parseBigInt(b);var result = this.parseBigInt();var decLength = 0, temp;if (x.isDecimal() || y.isDecimal()) {decLength = Math.max(x.decArray.length, y.decArray.length);for (var i = 0; i < decLength; i++) {temp = x.decArray.pop();x.array.unshift(temp ? temp : 0);temp = y.decArray.pop();y.array.unshift(temp ? temp : 0);}checkZero(x.array);checkZero(y.array);}if (x.negative == y.negative) {result.array = _plus(x.array, y.array);result.negative = x.negative;} else {if (a_LessThan_b(x.array, y.array)) {result.array = _minus(y.array, x.array);result.negative = y.negative;} else {result.array = _minus(x.array, y.array);result.negative = x.negative;}}for (var j = 0, len = decLength; j < len; j++) {temp = result.array.shift();result.decArray.push(temp ? temp : 0);}if (result.array.length === 0) {result.array.push(0);}checkDecArray.call(this, result.decArray);return result;};var _plus = function (x, y) {var ret = [], carry = 0, sum;if (x.length < y.length) {ret = _plus(y, x);return ret;}for (var i = 0; i < y.length; i++) {sum = x[i] + y[i] + carry;if (sum > 9) {carry = 1;ret.push(sum - 10);} else {carry = 0;ret.push(sum);}}for (; i < x.length; i++) {sum = x[i] + carry;if (sum > 9) {carry = 1;ret.push(sum - 10);} else {carry = 0;ret.push(sum);}}if (carry) {ret.push(carry);}checkZero(ret);return ret;};thi$.minus = function (b) {var y = this.parseBigInt(b + "");y.negative = !y.negative;return this.plus(y);};var _minus = function (x, y) {var ret = [], borrow = false, _x, _y;for (var i = 0, len = y.length; i < len; i++) {_x = borrow ? x[i] - 1 : x[i];_y = y[i];if (_y > _x) {borrow = true;ret.push(10 + _x - _y);} else {borrow = false;ret.push(_x - _y);}}for (len = x.length; i < len; i++) {if (borrow) {if (x[i] > 0) {borrow = false;ret.push(x[i] - 1);} else {borrow = true;ret.push(10 + x[i] - 1);}} else {ret.push(x[i]);}}checkZero(ret);return ret;};thi$.multiply = function (b) {var x = this.parseBigInt(this), y = this.parseBigInt(b);var result = this.parseBigInt(), negative = x.negative == y.negative ? false : true;var decLength = 0, temp;if (x.isDecimal() || y.isDecimal()) {decLength = Math.max(x.decArray.length, y.decArray.length);for (var i = 0; i < decLength; i++) {temp = x.decArray.pop();x.array.unshift(temp ? temp : 0);temp = y.decArray.pop();y.array.unshift(temp ? temp : 0);}checkZero(x.array);checkZero(y.array);}if (a_MoreOrEqual_b(x.array, y.array)) {result.array = _multiply(x.array, y.array);} else {result.array = _multiply(y.array, x.array);}for (var j = 0, len = decLength * 2; j < len; j++) {temp = result.array.shift();result.decArray.push(temp ? temp : 0);}if (result.array.length === 0) {result.array.push(0);}checkDecArray.call(this, result.decArray);result.negative = negative;return result;};var _multiply = function (x, y) {var array = [0], innerArray, temp, carry = 0;for (var i = 0; i < y.length; i++) {innerArray = [];if (y[i] === 0) {continue;}for (var k = 0; k < i; k++) {innerArray.push(0);}for (var j = 0; j < x.length; j++) {temp = y[i] * x[j] + carry;if (temp > 9) {carry = parseInt(temp / 10, 10);innerArray.push(temp % 10);} else {carry = 0;innerArray.push(temp);}}if (carry) {innerArray.push(carry);carry = 0;}array = _plus(array, innerArray);}return array;};thi$.divid = function (b) {var y = this.parseBigInt(b);if (isZero(this) && isZero(y)) {return NaN;}if (isZero(y)) {return !this.negative === y.negative ? Number.NEGATIVE_INFINITY : Number.POSITIVE_INFINITY;}if (isZero(this)) {return this.parseBigInt(0);}var result = this.divid_mod(y), modStr = result.mod.toString(), x = result.mod;var decLength = 0, temp;if (x.isDecimal() || y.isDecimal()) {decLength = Math.max(x.decArray.length, y.decArray.length);for (var i = 0; i < decLength; i++) {temp = x.decArray.pop();x.array.unshift(temp ? temp : 0);temp = y.decArray.pop();y.array.unshift(temp ? temp : 0);}checkZero(x.array);checkZero(y.array);}if (modStr !== "0") {var decPart = this.parseBigInt(x + "0000000000000000");temp = decPart.divisible(y).array;for (var i = 0, len = temp.length; i < 16 - len; i++) {temp.push(0);}result.ret.decArray = temp;checkDecArray.call(this, result.ret.decArray);}return result.ret;};thi$.divisible = function (b) {return this.divid_mod(b).ret;};thi$.mod = function (b) {return this.divid_mod(b).mod;};thi$.divid_mod = function (b) {var x = this.parseBigInt(this), y = this.parseBigInt(b);var result, mod, negative, flag = true;var decLength = Math.max(x.decArray.length, y.decArray.length), temp;if (x.isDecimal() || y.isDecimal()) {for (var i = 0; i < decLength; i++) {temp = x.decArray.pop();x.array.unshift(temp ? temp : 0);temp = y.decArray.pop();y.array.unshift(temp ? temp : 0);}checkZero(x.array);checkZero(y.array);}if (x.negative == y.negative) {negative = false;} else {negative = true;}if (isZero(x) && isZero(y)) {return {ret:NaN, mod:NaN};}if (isZero(y)) {return negative ? {ret:Number.NEGATIVE_INFINITY, mod:NaN} : {ret:Number.POSITIVE_INFINITY, mod:NaN};}if (isZero(x)) {return {ret:this.parseBigInt(0), mod:this.parseBigInt(0)};}if (a_LessThan_b(x.array, y.array)) {result = this.parseBigInt("0");result.negative = negative;mod = this.parseBigInt(x.toString());} else {var xObj, xArray = x.array.slice();var index, length, yLength = y.array.length, dividRet;result = this.parseBigInt();while (flag) {if (mod) {xArray = xArray.concat(mod);length = mod.length + 1;} else {length = 1;}index = xArray.length - length;if (index < 1) {flag = false;dividRet = _divid(xArray, y.array);result.array.unshift(dividRet.ret);mod = this.parseBigInt(dividRet.mod.reverse().join(""));mod.negative = negative;continue;} else {xObj = xArray.splice(index, length);dividRet = _divid(xObj, y.array);mod = dividRet.mod.length == 1 && dividRet.mod[0] === 0 ? undefined : dividRet.mod;result.array.unshift(dividRet.ret);}}result.negative = negative;}for (var j = 0, len = decLength; j < len; j++) {temp = mod.array.shift();mod.decArray.push(temp ? temp : 0);}if (result.array.length === 0) {result.array.push(0);}checkDecArray.call(this, mod.decArray);checkZero(result.array);return {ret:result, mod:mod};};var _divid = function (x, y) {var result = {ret:0, mod:[0]}, temp = x, flag = true;while (flag) {if (a_LessThan_b(temp, y)) {flag = false;result.mod = isZero(temp) ? result.mod : temp;} else {temp = _minus(temp, y);result.ret++;}}return result;};thi$.round = function () {if (this.decArray.length === 0) {return this;}var round = [];for (var i = 0; i < this.decArray.length; i++) {if (i === 0) {round.unshift(5);continue;}round.unshift(0);}if (!this.negative && a_MoreOrEqual_b(this.decArray, round)) {this.array = _plus(this.array, [1]);} else {if (this.negative && a_MoreThan_b(this.decArray, round)) {this.array = _plus(this.array, [1]);}}this.decArray = [];return this;};thi$.floor = function () {if (this.decArray.length === 0) {return this;}if (this.decArray.length !== 0 && this.negative) {this.array = _plus(this.array, [1]);}this.decArray = [];return this;};thi$.ceil = function () {if (this.decArray.length === 0) {return this;}if (this.decArray.length !== 0 && !this.negative) {this.array = _plus(this.array, [1]);}this.decArray = [];return this;};thi$.lessThan = function (b) {var x = this, y = this.parseBigInt(b);if (y.negative < x.negative) {return true;} else {if (y.negative > x.negative) {return false;}}switch (arrayComparison(x.array, y.array)) {case 0:return x.negative ? false : true;case 1:return false;case 2:default:return x.negative ? true : false;}};thi$.equal = function (b) {var x = this, y = this.parseBigInt(b);return x.negative === y.negative && a_Equals_b(x.array, y.array);};thi$.moreThan = function (b) {return !this.lessThan(b) && !this.equal(b);};thi$.lessOrEqual = function (b) {return !this.moreThan(b);};thi$.moreOrEqual = function (b) {return !this.lessThan(b);};var isZero = function (a) {return a.toString() === "0";};var a_LessThan_b = function (a, b) {return !(arrayComparison(a, b) && true);};var a_Equals_b = function (a, b) {return arrayComparison(a, b) === 1;};var a_MoreThan_b = function (a, b) {return arrayComparison(a, b) === 2;};var a_LessOrEqual_b = function (a, b) {return !a_MoreThan_b(a, b);};var a_MoreOrEqual_b = function (a, b) {return !a_LessThan_b(a, b);};var arrayComparison = function (x, y) {var arrayA = x, arrayB = y, aLen = arrayA.length, bLen = arrayB.length;if (aLen > bLen) {return 2;} else {if (aLen < bLen) {return 0;}}for (var i = aLen - 1; i > -1; i--) {if (arrayA[i] < arrayB[i]) {return 0;} else {if (arrayA[i] > arrayB[i]) {return 2;}}}return 1;};var createBigInt = function (str) {var ret = this, i = 0;var arr = str.split("."), intArr = arr[0], decArr = arr.length > 1 ? arr[1] : [];if (intArr.charAt(0) == "-") {i = 1;ret.negative = true;}for (var len = intArr.length; i < len; i++) {ret.array.unshift(+intArr.charAt(i));}if (decArr.length !== 0) {for (var j = 0; j < decArr.length; j++) {ret.decArray.unshift(+decArr.charAt(j));}}checkZero(ret.array);checkDecArray.call(this, ret.decArray);return ret;};var isNeed2BigInt = function (str) {return str.length > 15;};var checkZero = function (array) {var flag = true;for (var i = array.length - 1; i > 0; i--) {if (flag && array[i] !== 0) {flag = false;}if (flag) {array.pop();}}};var checkDecArray = function (decArray) {var decLen = decArray.length;if (decLen > this.decMaxLen) {decArray.splice(0, decLen - this.decMaxLen);}decLen = decArray.length;for (var i = 0; i < decLen; ) {if (decArray[i] !== 0) {break;}decArray.shift();}};thi$.isDecimal = function () {return this.decArray.length !== 0;};thi$.isDecMaxLen = function () {return this.decArray.length === this.getDecMaxLen();};thi$.getDecMaxLen = function () {return this.decMaxLen;};thi$._init = function (data) {this.array = [0];this.decArray = [];this.decMaxLen = 16;this.negative = false;this.pattern = "####";this.objTypeIsBigIntType = true;if (!data) {return;}switch (Class.typeOf(data)) {case "string":if (Class.isNumber(+data)) {createBigInt.call(this, data);} else {throw "This data type can not parse to BigInt type.";}break;case "number":createBigInt.call(this, "" + data);break;default:throw "This data type can not parse to BigInt type.";}};this._init.apply(this, arguments);}.$extend(js.lang.Object);js.text.BigIntTools.BigInt = js.text.BigInt;

$package("js.text");js.text.DateFormatSymbols = function (symbols) {var CLASS = js.text.DateFormatSymbols, thi$ = CLASS.prototype;if (CLASS.__defined) {this._init.apply(this, arguments);return;}CLASS.__defined = true;var Class = js.lang.Class, System = J$VM.System;CLASS.Default = {eras:["BC", "AD"], lMonths:["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"], sMonths:["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"], lWeekdays:["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"], sWeekdays:["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"], ampm:["AM", "PM"]};thi$.getEras = function () {return this.symbols.eras;};thi$.getMonths = function () {return this.symbols.lMonths;};thi$.getShortMonths = function () {return this.symbols.sMonths;};thi$.getWeekdays = function () {return this.symbols.lWeekdays;};thi$.getShortWeekdays = function () {return this.symbols.sWeekdays;};thi$.getAmPmStrings = function () {return this.symbols.ampm;};thi$._init = function (symbols) {var syb = System.objectCopy(CLASS.Default, null, true);syb = System.objectCopy(symbols || {}, syb, true);var _ = js.util.LinkedList;_.$decorate(syb.eras);_.$decorate(syb.lMonths);_.$decorate(syb.sMonths);_.$decorate(syb.lWeekdays);_.$decorate(syb.sWeekdays);_.$decorate(syb.ampm);this.symbols = syb;};this._init.apply(this, arguments);}.$extend(js.lang.Object);

$package("js.text");js.text.NumberFormatSymbols = function (symbols) {var CLASS = js.text.NumberFormatSymbols, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;var Class = js.lang.Class, System = J$VM.System;CLASS.Default = {zero:"0", grouping:",", decimal:".", perMill:"\u2030", percent:"%", digit:"#", minus:"-", currency:"$", intlCurrency:"\xa4"};thi$.getZeroDigit = function () {return this.symbols.zero;};thi$.getGroupingSeparator = function () {return this.symbols.grouping;};thi$.getDecimalSeparator = function () {return this.symbols.decimal;};thi$.getPerMill = function () {return this.symbols.perMill;};thi$.getPercent = function () {return this.symbols.percent;};thi$.getDigit = function () {return this.symbols.digit;};thi$.getMinusSign = function () {return this.symbols.minus;};thi$.getCurrencySymbol = function () {return this.symbols.currency;};thi$.getInternationalCurrencySymbol = function () {return this.symbols.intlCurrency;};thi$._init = function (symbols) {var syb = System.objectCopy(CLASS.Default, null);syb = System.objectCopy(symbols || {}, syb);this.symbols = syb;};this._init.apply(this, arguments);}.$extend(js.lang.Object);

$package("js.text");js.text.Format = function (pattern, symbols) {var CLASS = js.text.Format, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;thi$._pad = function (val, len) {val = "000" + String(val);return val.slice(val.length - (len || 2));};thi$.setPattern = function (pattern) {this.pattern = pattern;};thi$.setSymbols = function (symbols) {this.symbols = symbols;};thi$.format = function (value) {return value ? value.toString() : value;};thi$.parse = function (strValue) {return strValue;};thi$._init = function (pattern, symbols) {this.setPattern(pattern);this.setSymbols(symbols);};this._init.apply(this, arguments);}.$extend(js.lang.Object);(function () {js.text.DefaultNumberSymbols = new js.text.NumberFormatSymbols();if (Number.DF === undefined) {Number.DF = new js.text.NumberFormat();Number.prototype.$format = function (pattern) {if (pattern) {Number.DF.setPattern(pattern);}return Number.DF.format(this);};Number.$parse = function (str, pattern, symbols) {if (symbols) {Number.DF.setSymbols(symbols);}if (pattern) {Number.DF.setPattern(pattern);}return Number.DF.parse(str);};}js.text.DefaultDateSymbols = new js.text.DateFormatSymbols();if (Date.SF === undefined) {Date.SF = new js.text.SimpleDateFormat();Date.prototype.$format = function (pattern, isUTC) {if (pattern) {Date.SF.setPattern(pattern);}return Date.SF.format(this, isUTC);};Date.$parse = function (datestr, pattern, symbols, isUTC) {if (pattern) {Date.SF.setPattern(pattern);}if (symbols) {Date.SF.setSymbols(symbols);}return Date.SF.parse(datestr, isUTC);};}}).$delay(this, 0);

$package("js.text");$import("js.text.Format");js.text.YearFormat = function (pattern, symbols) {var CLASS = js.text.YearFormat, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;thi$.setPattern = function (pattern) {this.pattern = pattern || "yyyy";};thi$.format = function (value) {return this._pad(value, this.pattern.length);};this._init.apply(this, arguments);}.$extend(js.text.Format);

$package("js.text");$import("js.text.Format");js.text.MonthFormat = function (pattern, symbols) {var CLASS = js.text.MonthFormat, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;var Class = js.lang.Class;thi$.setPattern = function (pattern) {this.pattern = pattern || "MM";};thi$.setSymbols = function (symbols) {this.symbols = new (Class.forName("js.text.DateFormatSymbols"))(symbols);}.$override(this.setSymbols);thi$.format = function (value) {var ret;switch (this.pattern) {case "M":ret = (value + 1) + "";break;case "MM":ret = this._pad((value + 1), 2);break;case "MMM":ret = this.symbols.getShortMonths()[value];break;default:ret = this.symbols.getMonths()[value];break;}return ret;};this._init.apply(this, arguments);}.$extend(js.text.Format);

$package("js.text");$import("js.text.Format");js.text.HourFormat = function (pattern, symbols) {var CLASS = js.text.HourFormat, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;thi$.setPattern = function (pattern) {this.pattern = pattern || "HH";};thi$.format = function (value) {var ret;switch (this.pattern) {case "h":ret = ((value % 12) || 12) + "";break;case "hh":ret = this._pad((value % 12) || 12, 2);break;case "H":ret = value + "";break;default:ret = this._pad(value, 2);break;}return ret;};this._init.apply(this, arguments);}.$extend(js.text.Format);

$package("js.text");$import("js.text.Format");js.text.MinuteFormat = function (pattern, symbols) {var CLASS = js.text.MinuteFormat, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;thi$.setPattern = function (pattern) {this.pattern = pattern || "mm";};thi$.format = function (value) {var ret;switch (this.pattern) {case "m":case "s":ret = value + "";break;case "mm":case "ss":ret = this._pad(value, 2);break;}return ret;};this._init.apply(this, arguments);}.$extend(js.text.Format);

$package("js.text");$import("js.text.Format");$import("js.util.LinkedList");js.text.SimpleDateFormat = function (pattern, DateFormatSymbols) {var CLASS = js.text.SimpleDateFormat, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;var Class = js.lang.Class, System = J$VM.System;var TOKEN = /yy(?:yy)?|M{1,}|d{1,2}|E{1,}|([Hhms])\1?|S(?:SS)?|[azZG]|"[^"]*"|'[^']*'/g;var TIMEZONE = /\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g;var Regx = {yy:"(\\d{2})", yyyy:"(\\d{4})", G:"(\\S+)", M:"([1-9]|1[012])", MM:"(0[1-9]|1[012])", MMM:"(\\S+)", MMMM:"(\\S+)", d:"(3[01]|[12][0-9]|[1-9])", dd:"(0[1-9]|[12][0-9]|3[01])", E:"(\\S+)", EE:"(\\S+)", EEE:"(\\S+)", EEEE:"(\\S+)", H:"([0-9]|1[0-9]|2[0-3])", HH:"(0[0-9]|1[0-9]|2[0-3])", h:"([1-9]|1[012])", hh:"(0[1-9]|1[012])", a:"(\\S+)", m:"([0-9]|[1-5][0-9])", mm:"([0-5][0-9])", s:"([0-9]|[1-5][0-9])", ss:"([0-5][0-9])", S:"(\\d{1,3})", SSS:"(\\d{3})", z:"(\\S+)", Z:"([\\-\\+]\\d{2,4})"};var SetterOrder = js.util.LinkedList.$decorate(["y", "M", "d"]);var Getter = new function () {var _pad = function (val, len) {val = "000" + String(val);return val.slice(val.length - (len || 2));};var _week = function (D, $, b) {return b ? D.getUTCDay() : D.getDay();};this.yy = function (D, $, b) {return _pad(this.yyyy(D, $, b), 2);};this.yyyy = function (D, $, b) {return _pad((b ? D.getUTCFullYear() : D.getFullYear()), 4);};this.M = function (D, $, b) {return (b ? D.getUTCMonth() : D.getMonth()) + 1;};this.MM = function (D, $, b) {return _pad(this.M(D, $, b), 2);};this.MMM = function (D, $, b) {return $.getShortMonths()[this.M(D, $, b) - 1];};this.MMMM = function (D, $, b) {return $.getMonths()[this.M(D, $, b) - 1];};this.d = function (D, $, b) {return b ? D.getUTCDate() : D.getDate();};this.dd = function (D, $, b) {return _pad(this.d(D, $, b), 2);};this.E = function (D, $, b) {return $.getShortWeekdays()[_week(D, $, b)];};this.EE = function (D, $, b) {return $.getShortWeekdays()[_week(D, $, b)];};this.EEE = function (D, $, b) {return $.getShortWeekdays()[_week(D, $, b)];};this.EEEE = function (D, $, b) {return $.getWeekdays()[_week(D, $, b)];};this.H = function (D, $, b) {return b ? D.getUTCHours() : D.getHours();};this.HH = function (D, $, b) {return _pad(this.H(D, $, b), 2);};this.h = function (D, $, b) {return this.H(D, $, b) % 12 || 12;};this.hh = function (D, $, b) {return _pad(this.h(D, $, b), 2);};this.m = function (D, $, b) {return b ? D.getUTCMinutes() : D.getMinutes();};this.mm = function (D, $, b) {return _pad(this.m(D, $, b), 2);};this.s = function (D, $, b) {return b ? D.getUTCSeconds() : D.getSeconds();};this.ss = function (D, $, b) {return _pad(this.s(D, $, b));};this.S = function (D, $, b) {return b ? D.getUTCMilliseconds() : D.getMilliseconds();};this.SSS = function (D, $, b) {return _pad(this.S(D, $, b), 3);};this.a = function (D, $, b) {return $.getAmPmStrings()[this.H(D, $, b) < 12 ? 0 : 1];};this.G = function (D, $, b) {return $.getEras()[parseInt(this.yyyy(D, $, b), 10) < 0 ? 0 : 1];};this.z = function (D, $, b) {return b ? "UTC" : (String(D).match(TIMEZONE) || [""]).pop().replace(/[^-+\dA-Z]/g, "");};this.Z = function (D, $, b) {var o = D.getTimezoneOffset(), ao = Math.abs(o);return (o > 0 ? "-" : "+") + _pad(Math.floor(ao / 60) * 100 + ao % 60, 4);};}();var Setter = new function () {var _toFullYear = function (v) {v = parseInt(v, 10);if (isNaN(v) || (v.toString().length > 2)) {return v;}var d = new Date(), defaultCenturyStartYear = d.getFullYear() - 80, ambiguousTwoDigitYear = defaultCenturyStartYear % 100;v += parseInt(defaultCenturyStartYear / 100) * 100 + (v < ambiguousTwoDigitYear ? 100 : 0);return v;};this.yy = function (D, v, $, b) {v = _toFullYear(v);return this.yyyy(D, v, $, b);};this.yyyy = function (D, v, $, b) {var y = parseInt(v, 10);D.y = (y > 0 && D.bc) ? 0 - y : y;b ? D.setUTCFullYear(D.y) : D.setFullYear(D.y);return D;};this.M = function (D, v, $, b) {var M = parseInt(v, 10) - 1;b ? D.setUTCMonth(M) : D.setMonth(M);return D;};this.MM = function (D, v, $, b) {return this.M(D, v, $, b);};this.MMM = function (D, v, $, b) {var i = $.getShortMonths().indexOf(v);return i != -1 ? this.M(D, i + 1, $, b) : D;};this.MMMM = function (D, v, $, b) {var i = $.getMonths().indexOf(v);return i != -1 ? this.M(D, i + 1, $, b) : D;};this.d = function (D, v, $, b) {var d = parseInt(v, 10);b ? D.setUTCDate(d) : D.setDate(d);return D;};this.dd = function (D, v, $, b) {return this.d(D, v, $, b);};this.E = function (D, v, $, b) {return D;};this.EE = function (D, v, $, b) {return D;};this.EEE = function (D, v, $, b) {return D;};this.EEEE = function (D, v, $, b) {return D;};this.H = function (D, v, $, b) {var h = parseInt(v, 10);D.h = (h < 12 && D.pm) ? (h + 12) % 24 : h;b ? D.setUTCHours(D.h) : D.setHours(D.h);return D;};this.HH = function (D, v, $, b) {return this.H(D, v, $, b);};this.h = function (D, v, $, b) {return this.H(D, v, $, b);};this.hh = function (D, v, $, b) {return this.H(D, v, $, b);};this.m = function (D, v, $, b) {var m = parseInt(v, 10);b ? D.setUTCMinutes(m) : D.setMinutes(m);return D;};this.mm = function (D, v, $, b) {return this.m(D, v, $, b);};this.s = function (D, v, $, b) {var s = parseInt(v, 10);b ? D.setUTCSeconds(s) : D.setSeconds(s);return D;};this.ss = function (D, v, $, b) {return this.s(D, v, $, b);};this.S = function (D, v, $, b) {var S = parseInt(v, 10);b ? D.setUTCMilliseconds(S) : D.setMilliseconds(S);return D;};this.SSS = function (D, v, $, b) {return this.S(D, v, $, b);};this.a = function (D, v, $, b) {switch ($.getAmPmStrings().indexOf(v)) {case 0:D.am = true;return (D.h && D.h == 12) ? this.H(D, 0, $, b) : D;case 1:D.pm = true;return D.h ? this.H(D, D.h, $, b) : D;}return D;}, this.G = function (D, v, $, b) {if ($.getEras().indexOf(v) === 0) {D.bc = true;return D.y ? this.yyyy(D, D.y, $, b) : D;}return D;};this.z = function (D, v, $, b) {return D;};this.Z = function (D, v, $, b) {return D;};}();thi$.setPattern = function (pattern) {pattern = this.pattern = pattern || "EEE MMM dd HH:mm:ss yyyy";CLASS.infos = CLASS.infos || {};var info = CLASS.infos[pattern], pIndex, str;if (info) {return;}info = CLASS.infos[pattern] = {};pIndex = info.pIndex = js.util.LinkedList.newInstance();pattern = js.lang.String.escapeRxMetaChars(pattern);str = pattern.replace(TOKEN, function ($0) {var t = $0.charAt(0);$0 = ((t == "M" || t == "E") && $0.length > 4) ? $0.slice(0, 4) : $0;if (typeof Setter[$0] === "function") {pIndex.push($0);return Regx[$0];}if ($0.length >= 2) {$0 = $0.replace(/"|'/g, "");}return $0;});info.dPattern = new RegExp(str);}.$override(this.setPattern);thi$.setDateFormatSymbols = function (DateFormatSymbols) {this.symbols = DateFormatSymbols || new (Class.forName("js.text.DateFormatSymbols"))();};thi$.setSymbols = function (symbols) {this.symbols = symbols || new (Class.forName("js.text.DateFormatSymbols"))();}.$override(this.setSymbols);thi$.format = function (date, isUTC) {date = date ? date : new Date();if (!Class.isDate(date)) {return date;}var _symbols = this.symbols;return this.pattern.replace(TOKEN, function ($0) {var t = $0.charAt(0);$0 = ((t == "M" || t == "E") && $0.length > 4) ? $0.slice(0, 4) : $0;return (typeof Getter[$0] === "function") ? Getter[$0](date, _symbols, isUTC) : $0.slice(1, $0.length - 1);});}.$override(this.format);thi$.parse = function (datestr, strict, isUTC) {var info = CLASS.infos[this.pattern], pIndex = info.pIndex, _symbols = this.symbols, date, m = datestr.match(info.dPattern), $0, v, idx, mvs = [], i, len, obj;if (m) {date = new Date(1970, 0, 1);for (i = 1, len = m.length; i < len; i++) {$0 = pIndex[i - 1];v = m[i];idx = SetterOrder.indexOf($0.charAt(0));if (idx !== -1) {mvs[idx] = [$0, v];} else {date = Setter[$0](date, m[i], _symbols, isUTC);}}for (i = 0, len = mvs.length; i < len; i++) {obj = mvs[i];if (obj) {date = Setter[obj[0]](date, obj[1], _symbols, isUTC);}}return date;}if (strict !== true) {try {date = new Date(Date.parse(datestr));}catch (x) {}}if (!Class.isDate(date)) {throw SyntaxError("Invalid date string");}return date;}.$override(this.parse);this._init.apply(this, arguments);}.$extend(js.text.Format);

$package("js.text");$import("js.text.Format");js.text.NumberFormat = function (pattern, symbols) {var CLASS = js.text.NumberFormat, thi$ = CLASS.prototype;if (CLASS.__defined__) {this._init.apply(this, arguments);return;}CLASS.__defined__ = true;var Class = js.lang.Class, System = J$VM.System;thi$.setPattern = function (pattern) {var syb = this.symbols, grouping = syb.getGroupingSeparator(), minus = syb.getMinusSign(), decimal = syb.getDecimalSeparator(), percent = syb.getPercent(), permill = syb.getPerMill(), digit = syb.getDigit(), zero = syb.getZeroDigit(), buf = [];pattern = this.pattern = pattern || function () {buf.push(digit, grouping, digit, digit, digit, decimal, digit, digit);return buf.join("");};CLASS.infos = CLASS.infos || {};var info = CLASS.infos[pattern];if (info) {return;}info = CLASS.infos[pattern] = {};var phase = 0, prefix = info.prefix = [], surfix = info.surfix = [], integer = info.integer = [], fraction = info.fraction = [];for (var i = 0, len = pattern.length; i < len; i++) {var c = pattern.charAt(i);switch (c) {case digit:case zero:case grouping:if (phase == 0 || phase == 1) {phase = 1;integer.push(c);} else {if (phase == 2) {fraction.push(c);} else {throw "Malformed pattern " + pattern;}}break;case decimal:if (phase == 1 || phase == 0) {phase = 2;} else {if (phase == 2) {throw "Malformed pattern " + pattern;}}break;case percent:if (phase == 1 || phase == 2) {phase = 3;info.percent = c;}surfix.push(c);break;case permill:if (phase == 1 || phase == 2) {phase = 3;info.permill = c;}surfix.push(c);break;default:if (phase == 0) {prefix.push(c);} else {phase = 3;surfix.push(c);}break;}}for (i = integer.length - 1; i >= 0; i--) {if (integer[i] != grouping) {continue;} else {info.groupsize = integer.length - 1 - i;break;}}}.$override(this.setPattern);thi$.setSymbols = function (symbols) {this.symbols = symbols || new (Class.forName("js.text.NumberFormatSymbols"))();}.$override(this.setSymbols);thi$.format = function (value) {if (!Class.isNumber(value)) {return "NaN";}var info = CLASS.infos[this.pattern], syb = this.symbols, grouping = syb.getGroupingSeparator(), minus = syb.getMinusSign(), decimal = syb.getDecimalSeparator(), percent = syb.getPercent(), permill = syb.getPerMill(), digit = syb.getDigit(), zero = syb.getZeroDigit(), intl = syb.getInternationalCurrencySymbol(), buf = [], d = _parse.call(this, value.toString()), f0 = d.fraction.length, f1 = info.fraction.length, i = parseInt(d.integer.join("")), s = i < 0 ? -1 : 1, f = _digits2Number(d.fraction), b = Math.pow(10, f0), c;value = (Math.abs(i) * b) + f;value = info.percent ? value * 100 : info.permill ? value * 1000 : value;if (f1 < f0) {value = Math.round(value / Math.pow(10, f0 - f1));value /= Math.pow(10, f1);} else {value /= b;}d = _parse.call(this, value.toString());var surfix = info.surfix;for (i = surfix.length - 1; i >= 0; i--) {c = surfix[i];buf.unshift(c);}for (i = info.fraction.length - 1; i >= 0; i--) {c = d.fraction[i];if (c) {buf.unshift(c);} else {if (info.fraction[i] == zero) {buf.unshift("0");}}if (i == 0) {buf.unshift(decimal);}}b = info.groupsize || Number.MAX_VALUE;for (i = d.integer.length - 1; i >= 0; i--) {c = d.integer[i];buf.unshift(c);b--;if (b == 0 && i > 0) {buf.unshift(grouping);b = info.groupsize;}}var prefix = info.prefix;for (i = prefix.length - 1; i >= 0; i--) {c = prefix[i];if (c == intl) {buf.unshift(syb.getCurrencySymbol());} else {buf.unshift(c);}}buf.unshift(s == -1 ? minus : " ");return buf.join("");}.$override(this.format);var _parse = function (str) {var syb = this.symbols, grouping = syb.getGroupingSeparator(), minus = syb.getMinusSign(), decimal = syb.getDecimalSeparator(), percent = syb.getPercent(), permill = syb.getPerMill(), ret = {isNaN:true, integer:[], fraction:[]}, integer = ret.integer, fraction = ret.fraction, c, phase = 0;for (var i = 0, len = str.length; i < len; i++) {c = str.charAt(i);switch (c) {case "+":case minus:if (phase == 0) {integer.push(c);} else {return ret;}break;case "0":case "1":case "2":case "3":case "4":case "5":case "6":case "7":case "8":case "9":if (phase == 0) {integer.push(c);} else {if (phase == 1) {fraction.push(c);} else {return ret;}}break;case decimal:if (phase == 0) {phase = 1;} else {return ret;}break;case percent:if (phase != 2) {ret.percent = c;phase = 2;} else {return ret;}break;case permill:if (phase != 2) {ret.permill = c;phase = 2;} else {return ret;}break;default:break;}}ret.isNaN = false;return ret;};var _digits2Number = function (array) {var ret = 0;for (var i = 0, len = array.length; i < len; i++) {ret += (array[i] * Math.pow(10, len - 1 - i));}return ret;};thi$.parse = function (str) {if (!Class.isString(str)) {return Number.NaN;}var d = _parse.call(this, str);if (d.isNaN) {return NaN;}var integerStr = d.integer.join(""), i = parseInt(integerStr), s = integerStr.indexOf("-") != -1 ? -1 : 1, f = _digits2Number(d.fraction), b = Math.pow(10, d.fraction.length);f = s * (Math.abs(i * b) + f) / b;f = d.percent ? f / 100 : (d.permill ? f / 1000 : f);return f;}.$override(this.parse);thi$._init = function (pattern, symbols) {this.setSymbols(symbols);this.setPattern(pattern);};this._init.apply(this, arguments);}.$extend(js.text.Format);

(function () {js.lang.Object.$decorate(this);var ua = navigator.userAgent.toLowerCase(), ieTridents, trident, s, b;if ("ActiveXObject" in self) {b = (s = ua.match(/msie ([\d.]+)/)) ? this.ierv = s[1] : (s = ua.match(/rv:([\d.]+)/)) ? this.ierv = s[1] : 0;ieTridents = {"trident/7.0":11, "trident/6.0":10, "trident/5.0":9, "trident/4.0":8};trident = (s = ua.match(/(trident\/[\d.]+)/)) ? s[1] : undefined;this.ie = ieTridents[trident] || this.ierv;} else {b = (s = ua.match(/firefox\/([\d.]+)/)) ? this.firefox = s[1] : (s = ua.match(/chrome\/([\d.]+)/)) ? this.chrome = s[1] : (s = ua.match(/opera.([\d.]+)/)) ? this.opera = s[1] : (s = ua.match(/version\/([\d.]+).*safari/)) ? this.safari = s[1] : 0;}var env = this.env, uri = env.uri = new js.net.URI(location.href), params = uri.params, value, tmp, p;for (p in params) {if (p.indexOf("j$vm_") == 0) {value = params[p], tmp = parseInt(value);value = isNaN(tmp) ? (value === "true" ? true : (value === "false" ? false : value)) : tmp;env[p] = value;}}this.System = new js.lang.System(env, this);$postMessage = J$VM.MQ.post;$sendMessage = J$VM.MQ.send;this.$attachEvent = js.util.Event.attachEvent;this.$detachEvent = js.util.Event.detachEvent;this.SPE1 = "RR2kfidRR";this.SPE2 = "RR3uiokRR";var home = env.j$vm_home, file, libs = env.j$vm_classpath ? env.j$vm_classpath.split(";") : [];if (self.JSON == undefined) {this.Class.loadScript(home + "lib/json2.jz");}(function (file) {if (file.length === 0) {return;}this.Class.loadClass(home + file);}).$forEach(this, libs);}).call(self.J$VM);

